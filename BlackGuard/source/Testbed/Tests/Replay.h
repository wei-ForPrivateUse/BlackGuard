/*
 * Replay.h
 *
 *  Created on: Jan 14, 2015
 *      Author: wei
 */

#ifndef REPLAY_H_
#define REPLAY_H_

#include <iostream>
#include <fstream>

/// Simulation entrance.
class Replay: public Test {
public:
	Replay() {
		ANNWeights* w= new ANNWeights({19, 20, 2}, {false, true, false}, {false, true, true}, true);
		double w_c[] = {-0.15655435252018118, 0.12909996002477564, -0.04389518892262449, -0.09511516635961897, -0.06782012915234675, -0.4314943223177161, -0.31748631942290634, -0.3356004689790153, 0.36170581324629736, 0.21228957307577684, 0.7665007545139686, -0.08902884533264879, 0.5277201390213403, 0.00746190499963767, 0.6850830011486903, 0.388206870129806, 0.7675342911548906, -0.6269203216719095, 0.6731742181009708, 0.4218947205292647, 0.4230944237310957, 0.2765039821087243, -0.5674908892160548, -0.7230160473616519, 0.10073604660845423, 0.06045557855057139, -0.4037785425701659, -0.07644901390672591, 0.4899834440456434, 0.1910894912648888, -0.09823735737781569, 0.7489506882604284, -0.15970765748332602, -0.09053874416666184, 0.27846881956139535, -0.010558589624729123, 0.38935854576673473, -0.35045985812006547, -0.0736206179630547, -0.5636954481805628, -0.33274441797950083, 0.09401851998838479, 0.25018823574938365, 0.08591451923145693, -0.37707802905134624, -0.37286681110690434, 0.1311323707143323, 0.02917077964709948, -0.1240946402716736, -0.45318586382889725, 0.24029800590899594, -0.34896470480556313, -0.05916344504692691, -0.10745396171997798, -0.5234758806147921, 0.4073433292385453, -0.6264721366264835, 0.14650238245848232, 0.35768400634828984, -0.2731357364979636, -0.6028961334336221, -0.1273802305129097, -0.12097061318537472, -0.2282720764499995, 0.033298619687832015, 0.15655883403721413, 0.32183834157224617, -0.20734256221274755, 0.051708689192171794, -0.08148755327449413, 0.5368851502600211, 0.018816451528162803, -0.4218553108889869, 0.18865302738062556, -0.3100620164468532, -0.0772228837853936, -0.1675140781159603, -0.07103371309774184, -0.2917465588259905, 0.1850217343182811, 0.15568525469240876, -0.2514977119972224, 0.5439840186096693, 0.12442176875782789, 0.2550449669064102, 0.1939655586061622, -0.7163961422392098, -0.43799775354419773, -0.29372524876271183, -0.590716861906261, 0.3183003743437577, -0.6208879399467183, 0.40398693172158406, -0.7025893917057248, 0.41596806632958, -0.18866388600004855, -0.3609186497341603, 0.05617372798372787, 0.4640886930550555, 0.033974050626906005, -0.12862421556248185, -0.3682491293556288, 0.23692279927502774, 0.29799634810060305, -0.006553967406456182, 0.3048984926147084, 0.3090439909674808, 0.06336856755438637, -0.32136715219412726, 0.2905163866070142, 0.13619004680175698, -0.11577721140232103, -0.12083486009118474, -0.1369735520254361, 0.34577430502842266, -0.025831309909316813, 0.12826625390698246, -0.09296041981114461, 0.29606671499749015, 0.016262453779080352, 0.18182410681846706, -0.5337156714684216, 0.3752660469506374, 0.255513989506601, -0.11219237375009661, 0.2566992284307109, -0.1993462122492265, 0.5840057826518877, 0.050373110794287385, -0.4115511200021421, -0.06389080835790262, -0.3677295909936935, -0.12562200135196722, -0.013942182800784339, -0.3147599632711422, 0.48494978988783227, 0.26400002141645007, 0.1672646526391891, -0.16658507064476166, -0.41269370811830264, -0.281905717651301, -0.5062265594557132, -0.32273265659118855, -0.030914483659093883, 0.20544814575277076, 0.2550384439990908, 0.47587093197198066, -0.2597792330191934, 0.5668139046969392, 0.6096004753509596, 0.496422690809187, -0.01230641359492702, -0.6422052932378668, -0.12319850307247018, -0.3209311231651053, 0.3919468079625739, -0.6122680930048905, 0.20145604857887361, -0.2818471269755104, -0.41880367930485946, 0.7295692355243845, -0.3828463009910188, -0.06380006036497761, 0.19985921818324576, 0.2209278438923684, 0.11679953399424675, -0.7516811821930908, 0.3222117689820231, 0.4546114296775357, 0.33201879356911734, -0.41019817711527534, 0.04125736174222533, 0.5349213633493297, -0.061015102472151805, 0.5360052493227768, 0.4092453716983532, -0.022909433479574498, 0.35073357607835626, -0.1992516641489961, 0.430968330163772, -0.0965937756778632, -0.6339196036029341, 0.9525312564742934, -0.3560127956389537, -0.35952092558679, -0.6455650669986754, 0.1385167657729328, 0.3561669851972372, -0.4329866746829622, -0.26814127004418375, -0.4969478071672657, 0.3248269089295664, -0.19263986907112235, -0.1586082766523106, -0.6046591765882234, 0.7048978078128528, 0.4763986134952495, 0.8668157013902954, -0.5371961138427926, -0.3236641189541703, -0.31790131428716006, 0.07803085282792682, -0.3714415342147212, -0.01242600618737315, -0.40712226735930707, 0.1870243913750961, -0.5367619052365392, 0.12215105078896596, 0.46127708283929336, 0.24558074657927603, -0.5187949846729496, 0.48007440480946556, 0.14697653007922099, -0.425792169277868, 0.011392506855910171, -0.11713866675166207, 0.14965579100283305, 0.2188435536389529, 0.21787195339840826, -0.6404221909943505, 0.020793355731372754, -0.11376488523167702, 0.29150945691290026, -0.3477801907357986, -0.22677258962727745, 0.549432066524415, -0.789241519291946, -0.7083326860891378, -0.032687448813804046, -0.17272504893171628, -0.20472855365720688, -0.37670251411042505, -0.24886738293049893, 0.24891568106475465, 0.1208235244812596, 0.4823694721406573, 0.41019172599550313, 0.4280501909857026, -0.5604286777968149, -0.6595064089056555, -0.4892550415627098, 0.33018239182492326, -0.5095078060718952, -0.05937423970161901, -0.3154714507731039, -0.18345241150730246, -0.3185532167203002, -0.3032693439205254, -0.41934895384775017, 0.27210300723758213, 0.08702672424567448, 0.6072722678889392, -0.11269880457673578, -0.11002260239294522, -0.3331183840698812, 0.43723322864135433, -0.3449664737902134, -0.43745207578755085, 0.03744994904037355, -0.2891511192225766, 0.29298239636220036, 0.21475506656501264, -0.3186424990866975, 0.5121639160575338, -0.018669333312352883, -0.5192132097611817, 0.020696670464377932, 0.11990195639704754, 0.5706888440854144, 0.16388641799761763, -0.34618733216296754, 0.5967915711963239, -0.5925703498682935, -0.26205896021420366, 0.11202495667722204, -0.16228460451008697, 0.012799095924520137, -0.41321966938252414, 0.16873587635699633, -0.7249593822981842, -0.09476458865030145, 0.4258217834167375, -0.24970876149192345, -0.5770802304203163, 0.6499534368739882, -0.6610142521208201, 0.6348409278922701, 0.5399501806417422, -0.6508542210519261, -0.14467868478648277, -0.6470657920681234, -0.15934217698789205, 0.6915422261767054, -0.2054091824503284, 0.7156972862947109, 0.14960146517308068, -0.03275730245412181, 0.14590859243342946, 0.6019910751101627, -0.2506636271464828, 0.4931301308091579, -0.16148925811350615, 0.2930953092599843, -0.19226031730040527, 0.08147102735714842, 0.4711570548316778, 0.5465560951823989, -0.563593929610212, -0.5344322273201935, 0.21753319267838991, 0.18471370255622718, 0.5621884054578786, -0.37403252850919366, -0.5829573669833688, -0.2635561022108541, 0.09781339749385112, -0.5366484914728809, -0.7515068238575986, -0.19264696225155284, -0.6924252528830684, 0.5937399220017643, 0.5881089093917626, -0.6458337608081617, -0.41050086237066385, 0.6070638702826165, -0.49515709557978094, 0.5504669052400706, 0.20453408183479393, 0.6842725613330825, 0.32089616077922034, 0.8083277700095957, -0.5313544038538772, 0.12106758152243897, 0.13267364931412112, 0.8686243325607853, -0.7098610943627283, 0.5225423519373843, -0.5976317939009701, 0.7906891145536018, 0.5322776181220363, -0.582759291941774, -0.41808275400516837, -0.25307132597271237, 0.11449128526028662, 0.5693634371752139, 0.7144853490773236, 0.46005461458177277, -0.6465261234134346, -0.5013948814205619, -0.21111446847743776, 0.2730981761742938, -0.1082449150234798, 0.13137308618538196, -0.3298603896404555, 0.632980820534311, -0.02860355353354889, -0.35280021720076454, -0.6938717784809146, 0.025144290040744838, -0.0976923286843902, -0.2805856923795188, -0.42829160891629, 0.726790667938191, 0.14843077734432825, -0.2399594855428891, 0.7832934908874145, -0.21692430831585058, -0.3525592667528512, -0.6934232563984674, 0.374665626489281, -0.6144201436178898, -0.16070962690151622, -0.04135099308269616, -0.49723188465474666, 0.12835874960450655, -0.4795859921841137, -0.4213375844530703, -0.2241834080041719, -0.007080500487219983, -0.46427855576762866, -0.3974334224702832, 0.434742586595875, -0.27340021222507177, -0.07614331369563516, 0.6531809740342893, -0.1518847547040896, -0.18094552692352153, -0.5668002200171532, 0.36302274098894144, 0.6365638771419333, 0.16394082764922263, 0.08149286081951455, 0.7857294654905235, 0.7967928556333118, -0.4576237702554756, -0.8598840243841958, -0.7435323709398537, 0.6583488426333536, -0.09741970918505842, 0.6233764126670581, -5.275988766427209E-4, -0.09603470783626304, 0.09462003578977614, -0.45848580371350456, -0.12905037078126813, -0.1254973790548209, -0.4896297919062626, -0.07785474286249291, 0.12281157733584225, 0.4078342735315724, 0.7853092616334194, -0.17050017177520121, -0.7533503658255645, 0.25578593008796235, -0.3520645114446604, -0.21910224477777102, -0.38722690604302956, 0.5822111259695951, -0.6278312533942252, 0.5686688460550006, -0.29846027680514586, 0.2028815005907339, -0.6683390318711038, -0.26360427199038905, 0.11377770598454744, -0.23445002698261336, 0.4128230788046841, -0.6247226342678499, 0.5729374198420623, -0.5531419177532328, 0.44096931638983927, 0.5254111075704228, 0.04675917609211962, 0.15080305416939757, -0.367423143855888, 0.3746978502305043, -0.4961892387669935, 0.300852193478938, -0.042321217709688025, 0.08174938444130073, 0.019994261459968653, -0.3242023621356636, -0.5813048865788205, 0.12297766593548226, 0.007762660001072057, 0.05399554596957404, 0.5909651792798052, -0.052828490484044366, -0.09109248450489713, 0.2792620624970896, -0.19476246637774952, -0.6230091043171254, -0.5307912374736161, 0.4473414493856489, 0.013922143908372018, 0.24270973130501733, 0.41065533629751344, -0.7379405700057489, -0.28753602207179435, 0.15189825989337558, 0.10654744377916374, -0.49239151009640386, -0.15732455234029352, 0.3787177129226723, -0.5022061100013209, -0.5013561367312303, -0.4563562639056375, -0.3714902225509553, -0.3904191905979373, 0.04246464754400375, 0.5775125241121378, -0.3539468206652825, -0.10303252060282896, -0.4208598749650695, -0.6680031001090305, -0.33016833762407927, 0.36181758863081886, 0.3279555779215012, -0.45281926854044013, 0.0781491429280177, -0.6495455257074843, 0.18685983118861532, 0.5643813438147167, -0.047207452898865285, -0.4664969810127365, -0.5047441474801717, -0.2305770549289353, -0.2867324059807558, -0.011718409632917148, 0.16468449091208598, -0.21314609421405156, -0.23520024533143652, -0.09589898603154237, -0.17151058799399035, 0.24638710800681857, 0.402980006815136, -0.20786888956316865, -0.01709650707952093, 0.6460028307307958, 0.41988663686222444, 0.44222453777031584, 0.27610079095695184, -0.019156288068786317, -0.5967493056874016, 0.21163102393320865, -0.12565868766726496, 0.6704365514634003, -0.46658407408704883, 0.4138086241591642, 0.05947157064030115, 0.6697276740619476, -0.4880242631288034, -0.33442379072291945, -0.35150269478676877, 0.4721273400924398, -0.5555647940933717, 0.3209385769279368, 0.04202019516765863, -0.0712338086373494, -0.11443879144758347, -0.40080689007745096, -0.8194562226270047, 0.3989162222962233, 0.055669966464749546, -0.23179079638074976, 0.060880965459895665, 0.1856286845517163, -0.6299812601576826, -0.5971181910332503, -0.59449431853511, -0.562080523152096, 0.611898963142994, 0.327923679580554, -0.5007486156091822, 0.47175116776917403, 0.3026040343143908, -0.4933317365092601, 0.023632098006861807, -0.40331427839564193, -0.7195344106846167, -0.36846049417978166, 0.5857222235044983, -0.21755125140015735, -0.3779770907127208, -0.059001267580775375, -0.13375612971482573, -0.4862271158397452, 0.09119621837758449, -0.1036453379263864, -0.09654152755948958, -0.4587839641438756, 0.16335846021139924, -0.5333470032371439, 0.2744768127401697, 0.5717028310186398, 0.276946539209789, 0.13178969634307997, 0.005184018668749318, -0.7407864905796911, 0.40342966968368354, 0.1422848489971865, -0.2310489231027672, 0.010263422922406784, -0.18605837412255616, -0.455687476069944, 0.20841529582194307, -0.5064143943351094, 0.3354269188259266, 0.5567693939135625, -0.5145142085184682, -0.49628185347854364, -0.62681826692348, 0.292329662809508, -0.07367600491841132, -0.6494280304873482, 0.13225985559291292, 0.1485762327585356, 0.6935595122142976, -0.15316746680178078, -0.3836940679068332, -0.30426654074059856, -0.3322580828220829, -0.36094115557262596, -0.14235851349856052, 0.2203332656042017, -0.5551068944931067, 0.5984523257284152, -0.6856000887091274, 0.904926458598088, -0.21889079403687284, -0.03676568495213847, 0.034548200725499606, 0.4296792477679227, 0.18324491079302202, 0.7730133241080799, 0.16311018306467437, 0.35870065856495387, -0.5778434076145893, 0.06339397401465718, 0.24469512197930446, -0.6085368212726185, 0.2747274666634649, 0.1712166379748507, -0.6965027047146906, -0.6327069026363048, -0.46375850996378243, -0.24347856198002152, -0.18161564644634748, 0.2250171909670037, -0.4793149373156409, -0.26199485564642494, 0.5096022142071325, 0.2852289988373793, 0.19319816923680033, -0.3145968435631706, -0.3847396852508992, 0.14725115069554576, -0.16384709013948817, -0.4788440925586365, -0.49383749231753077, -0.16695740557575722, 0.021563398209358486, 0.2402694310276416, -0.8810506145332968, 0.2178826353227956, 0.21569413936429288, -0.4582209665780719, -0.3019172466937611, -0.013804977074257846, 0.00641826765051165, 0.056288666912323204, -0.5310487407396356, 0.5039530998051979, -0.620549018761795, -0.5035764647667057, -0.19828959143510513, 0.40060561351940294, -0.5704134132801028, -0.23806666251825603, -0.19992987282891775, -0.3527765588161742, -0.5729368733254895, -0.5189990091565824, 0.3411483379682177, 0.28799208440973934, -0.002701490551341286, 0.051565937685877423, 0.16949891981272452, 0.2709014577355994, -0.6055906859454074, 0.23859275081987036, -0.1960469593712698, -0.5292748050523236, -0.5906885962723685, 0.03613815127550157, 0.27911616775959186, 0.3248888479991848, 0.050864262816360126, 0.2186481895486237, -0.18349116613544686, 0.07812492889230094, -0.46514851942464563, -0.24342760085166726, -0.28147291374440886, 0.564350361819, 0.1157982446580941, 0.4163707967641672, 0.34050079542474865, 0.31816830636882854, 0.38011208029689514, 0.053097675871395356, -0.3720427488812648, 0.2585601112469324, -0.3151395081628161, 0.19135237070086739, 0.09461284278268747, -0.2887067265716474, 0.17208959844160737, 0.7490732335054998, -0.19031888150282456, 0.4668891411089792, -0.5952511830588496, 0.614042181812209, 0.5786269893112073, -0.21934991099028853, -0.3794366156891234, -0.5381452089509517, 0.2416560807959111, 0.3594808431603281, 0.03825641208917892, 0.20416527610561283, -0.42299843821961924, -0.18428426329210656, -0.1732759948033754, -0.5046905479989643, 0.36083567081564094, -0.22488788532720577, -0.567585199116543, 0.2916403234875229, -0.393464365778351, 0.3652521925167389, 0.0705930355818647, -0.2591842896043085, 0.5300466698759038, 0.6610182164126566, 0.18341658128199043, 0.11950586356560346, -0.3470740416005594, -0.07201095731503526, 0.47785458608441317, 0.09543538692262024, 0.16226438556928643, 0.3564496838803547, 0.4750594180743835, -0.028810241493337885, -0.41010542421553736, 0.03220104852049481, -0.7643890424563138, -0.29439953573200756, 0.5013746462888227, -0.6027674835098464, -0.4182802869160421, 0.23593559799056618, 0.46704143574066087, 0.30605862526422145, -0.5435786487172387, -0.35428212094768247, 0.2234220342164517, 0.20062129070007634, -0.7092618986399706, -0.11671799956925336, 0.12251862459117904, 0.09619485467956486, -0.6835187184626751, -0.2830613962774197, -0.1285963398338647, 0.17005802553113103, 0.24776820065425295, -0.4726212034155605, 0.47605215731538364, 0.20823932994791228, -0.596235635449679, -0.6191054412125532, -0.39804033006597006, 0.024912607453663173, -0.003436459814117967, -0.18143493362262314, 0.036579460225649056, 0.6157253241996303, 0.4904390654629409, -0.3526305955030652, 0.2545728275397477, 0.4119828333582669, -0.035700628025494854, -0.4411003055123289, -0.5433493424292306, -0.438675441873795, -0.7287149190772734, -0.035741615109603, 0.2560035002599991, -0.6707772880621596, 0.5107986298877087, 0.17213300928033445, -0.07843587941302324, -0.6391930724626572, 0.03373806672840228, -0.1574885519949959, 0.46646685734928084, -0.5486762959027336, 0.10725657943080502, -0.5831998952575758, 0.4406314949566263, -0.4855885717281902, -0.586399085686707, -0.5979679790517561, -0.2171366948723626, -0.03200070141315234, -0.14044117883582227, -0.6034175492817182, 0.6069151134243027, 0.2502257490940601, 0.4572018685677128, 0.33137762267417736, 0.23439625795303415, 0.8710342018990627, -0.36064207478196986, 0.4629938503334867, -0.6784861731612354, -0.096837270984543, -0.5380286292943295, -0.264030572338918, 0.3563474872481587, 0.22357890801345537, 0.15575558588067637, 1.4305228807981463E-4, -0.5252919865238415, 0.547221612836825, 0.11791338245723758, -0.3179943382945398, -0.3038485891574704, -0.48077904377125497, -0.10261627676405313, 0.06778946152333107, 0.4841036233772206, 0.1235294945288481, -0.40103583305314516, -0.31520325638669544, 0.4335891577117645, 0.6886052203807138, 0.19432428245637373, 0.5829804209036409, -0.3467740662008629, 0.373223226311025, -0.15650810967099832, 0.3945921869441897, -0.5701418558618704, -0.016613873901307905, 0.36482670110906246, -0.22156618884614632, 0.18386967574291327, 0.3294771048291767, -0.2151018700206068, -0.06403489658697598, 0.24236120847139145, -0.18332878838058375, -0.05689684637713522, -0.3581723071924057, 0.25642217345195417, 0.10546696647970702, -0.07583735672447346, -0.03878034861830877, -0.1562070023044843, -0.03854107132200536, 0.027626911891555563, -0.05073945922662198, -0.0720961859325653, -0.17104685873523598, 0.2791371490165558, -0.26536547993808224, 0.07477948974751031, -0.34800508605309316, 0.10659398556937615};
		w->Set(w_c);

		S_Field::Configuration sc;
		sc.TimeStep = 0.02;
		sc.World = m_world;
		sc.Robot=50;
		m_scenemgr = new  S_Field(&sc, w);
	}

	void Step(Settings* settings) {
		std::cout<<m_stepCount<<":   ";
		Test::Step(settings);

//		for(int i = 150; i < 152; i++) {
//			std::cout<<static_cast<S_Field*>(m_scenemgr)->m_robot[9]->GetDataPool().Get<float>(i)<<", ";
//		}

		Draw_W();
		std::cout<<std::endl;
	}

	/// Draw Nests.
	void DrawNest(float a) {
		m_debugDraw.DrawSegment(b2Vec2(-a, -a), b2Vec2(-a, a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(-a, a), b2Vec2(a, a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(a, a), b2Vec2(a, -a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(a, -a), b2Vec2(-a, -a),
				b2Color(0.8f, 0.8f, 0.8f));
	}

	void DrawCircleNest(const b2Vec2& center, float32 radius, const b2Color& color) {
		m_debugDraw.DrawCircle(center, radius, color);
	}

	/// Implementation function.
	static Test* Create() {
		return new Replay;
	}

	//////// Draw
	void Draw_W() {
			b2Vec2 w_v[10];

			w_v[7] = b2Vec2(24.85282f, 60.0f);
			w_v[6] = b2Vec2(-24.85282f, 60.0f);
			w_v[5] = b2Vec2(-60.0f, 24.85282f);
			w_v[4] = b2Vec2(-60.0f, -24.85282f);
			w_v[3] = b2Vec2(-24.85282f, -60.0f);
			w_v[2] = b2Vec2(24.85282f, -60.0f);
			w_v[1] = b2Vec2(60.0f, -24.85282f);
			w_v[0] = b2Vec2(60.0f, 24.85282f);
			DrawSolidPolygon(w_v, 8, b2Color(0.8, 0.8, 0.8));

			// walls
			DrawSegment(b2Vec2(24.85282f, 60.0f), b2Vec2(-24.85282f, 60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-24.85282f, 60.0f), b2Vec2(-60.0f, 24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-60.0f, 24.85282f), b2Vec2(-60.0f, -24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-60.0f, -24.85282f), b2Vec2(-24.85282f, -60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-24.85282f, -60.0f), b2Vec2(24.85282f, -60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(24.85282f, -60.0f), b2Vec2(60.0f, -24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(60.0f, -24.85282f), b2Vec2(60.0f, 24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(60.0f, 24.85282f), b2Vec2(24.85282f, 60.0f), b2Color(0.0f, 0.0f, 0.0f));

			// nest
			DrawSolidCircle(b2Vec2(0.0f, 0.0f), 15.0f, b2Color(0.65f, 0.65f, 0.65f));

			// robots
			for(auto robot : m_scenemgr->GetNodesByTag(MAKE_TAG('r', 'o', 'b', 'o'))) {
				b2Body* bd1 = static_cast<A_Robot*>(robot)->m_motor[0]->GetBody();
				w_v[0] = bd1->GetWorldPoint(b2Vec2(-0.25, -0.1));
				w_v[1] = bd1->GetWorldPoint(b2Vec2(0.25, -0.1));
				w_v[2] = bd1->GetWorldPoint(b2Vec2(0.25, 0.1));
				w_v[3] = bd1->GetWorldPoint(b2Vec2(-0.25, 0.1));
				DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));
				b2Body* bd2 = static_cast<A_Robot*>(robot)->m_motor[1]->GetBody();
				w_v[0] = bd2->GetWorldPoint(b2Vec2(-0.25, -0.1));
				w_v[1] = bd2->GetWorldPoint(b2Vec2(0.25, -0.1));
				w_v[2] = bd2->GetWorldPoint(b2Vec2(0.25, 0.1));
				w_v[3] = bd2->GetWorldPoint(b2Vec2(-0.25, 0.1));
				DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));
				b2Color col(0.0f, 0.0f, 0.9f);

	 			DrawSolidCircle(static_cast<A_Robot*>(robot)->GetMainComponent()->GetPosition(), 0.5f, col);

				if(robot->GetId()==9) {
					m_debugDraw.DrawCircle(static_cast<A_Robot*>(robot)->GetMainComponent()->GetPosition(), 12.0f, b2Color(0.4,0.9,0.8));
				}
			}

			// resource
			if(m_scenemgr->CountNodesByTag(MAKE_TAG('r', 'e', 's', 'o')) > 0) {
				for(auto resource : m_scenemgr->GetNodesByTag(MAKE_TAG('r', 'e', 's', 'o'))) {
					b2Color col;
					if(resource->GetFlag()==0) {
						col.Set(0.25f, 0.55f, 0.0f);
					} else {
						col.Set(0.9f, 0.0f, 0.0f);
					}
					DrawSolidCircle(static_cast<Block*>(resource)->GetPosition(), static_cast<Block*>(resource)->GetBody()->GetFixtureList()->GetShape()->m_radius, col);
				}
			}
		}
};

#endif /* REPLAY_H_ */
