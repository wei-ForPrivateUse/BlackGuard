/*
 * Replay.h
 *
 *  Created on: Jan 14, 2015
 *      Author: wei
 */

#ifndef REPLAY_H_
#define REPLAY_H_

#include <iostream>
#include <fstream>

/// Simulation entrance.
class Replay: public Test {
public:
	Replay() {
		ANNWeights* w= new ANNWeights({22, 20, 2}, {false, true, false}, {false, true, true}, true);

		double w_c[] = {0.9058157307289628, 0.30943768322804416, 0.5583539783661401, -0.6182211333516632, 0.4158204874194934, 0.0677940046358883, -0.7916777333721863, -0.9112277948665861, 0.566772082176243, 0.48645530988090974, -0.6331600160377518, 0.8615821084812318, -0.3820853925590097, -0.5730436079486435, 0.277864967158861, -0.5183660155703911, 0.7358220317776718, 0.7468102459817425, 0.7459989071524507, -0.7722661945760569, 0.4457156877960461, -0.5254453864844031, 0.7334512706650288, -0.4203059257376145, 0.16729748760230198, 0.5796680994049614, 0.7020820707603161, -0.8194447030404665, 0.8799879876320951, 0.8021647278841689, -0.45588377610907366, -0.04258543964332059, -0.5571715904466642, -0.15467953630588363, -0.7379747767374099, 0.1998346409776915, -0.18421091055895733, 0.42172131751148895, -0.369464302501631, 0.7750440534254501, -0.7855971858239233, -0.18173524068211844, -0.5520235960432555, 0.07504299512653059, -0.33628090461524224, 0.13031099051951353, 0.6016339866538504, 0.6420391938087996, 0.1969419896807474, 0.3294512786282023, 0.1198569824246456, -0.7038970714224884, -0.42512416851239704, -0.46962895915872516, -0.4512236628942299, -0.2240007459311949, -0.6450896356884339, -0.6518693259451124, -0.26575403362056593, 0.7759789675252308, 0.3828088397518752, 0.544367696212733, 0.5495015983134807, 0.1307280103794732, -0.3460272653601527, 0.45618390090240274, -0.4611840761423169, -0.8644524152484317, -0.42252307303488057, -0.32260651146860025, 0.06562324851447932, -0.2768101564177592, 0.5563347619055271, 0.11429646129059885, 0.07051310172986013, -0.09787959205184682, 0.017611056424817025, 0.2284941351955638, -0.6502517788691167, 0.3706613870556411, -0.34125524215585357, 0.4702153134086924, -0.3846947661382442, -0.7417240826503446, 0.2919746145006661, 0.5583032341246184, 0.4824899400837662, -0.08232986451348698, -0.2512442793513981, 0.42125966526207004, 0.6394298274010521, 0.34171938141039593, -0.11130492639201292, 0.002663040147344725, -0.7637135849057007, -0.5583892002300324, 0.06451060078352623, 0.4434911008956146, -0.22528413701520775, 0.21415526270571067, -0.38006402495358005, -0.07717242088976778, 0.5400746400184979, 0.14362262601297557, -0.5298430845904569, 0.4328790875827524, -0.32451124946321824, 0.19441300551599308, -0.2820522828866447, 0.12017843014556222, -0.6512402501506777, -0.619490600270204, -0.2802796873371205, 0.2243144081255751, 0.42483957808372474, 0.44987402922149544, -0.3635564699433358, 0.049205265722948754, -0.10842073124588793, -0.47940967293098846, -0.798341818774547, 0.3338469745297213, 0.4652403715671139, -0.3916818675693376, -0.5570057372939136, 0.4236507537688166, -0.14979910443084554, 0.20480878488691603, 0.3119778006004011, 0.558840041277168, 0.39678998973970375, -0.8929880401318442, -0.20570463578461862, -0.7643000819651565, -0.3393581529342072, -0.44768976914251185, -0.7994626741449693, 0.09642000146070259, 0.46057064169872913, 0.615747777780208, 0.39706234135303453, 0.5000079838457075, 0.3728960710730625, -0.5723340605407699, -0.4573201120337567, 0.05812516440938194, -0.5604700513375319, 0.7700254561768083, -0.02896563468626663, 0.2307279982972243, -0.2998779037287291, 0.5019039769658847, -0.6075149720810683, 0.4328797310230946, -0.6225688105504634, -0.4709767545975253, 0.39163199998254916, -0.4319810508580081, 0.755091397835848, -0.6119187351258425, 0.6637654006636231, -0.0032512294931767646, 0.37495674497120546, -0.15243135407416475, -0.1659880377751777, 0.31846900442271264, 0.5933699294703685, 0.55814079560641, 0.06643920745003398, 0.3644672040249036, -0.2867177797490228, 0.5578655317205511, 0.5562783159007925, -0.696679673463681, 0.2816300121099136, -0.8510828244339437, 0.06676292401803828, 0.22075372267403653, -0.33344695512543054, 0.4025739548148212, -0.21990416121813602, 0.19159500743622432, -0.5851954860271034, 0.19575085077179089, -0.6055404612429507, -0.7580644785253686, -0.5961935009065842, 0.25464545442314024, 0.08487635162521615, -0.48975607002642246, 0.43914822193015735, 0.34108369984948367, -0.025399443139009496, -0.02058382467403698, 0.4977418570887975, -0.07206383657360865, 0.26389426985000525, 0.017505698717140042, 0.16017694104175437, -0.17378819502617907, 0.4316868705757151, -0.0739441918208142, -0.4001681943107226, -0.45641191843414625, -0.09656920644467207, 0.597319931636934, -0.12630868832346048, -0.08087367622118473, 0.15101649750323876, -0.12102380375493879, -0.23066198048636177, -0.7372159274117859, 0.09124063563251751, 0.8381901867021104, -0.4605988782554817, -0.45355835475683204, 0.19247939599538105, 0.050270704848166536, -0.2931227438470665, 0.2177150280642911, 0.908464965431934, -0.49138961807131426, -0.32601339355993797, 0.3518742110084847, -0.5947119222399359, 0.6755286082894161, 0.271000703174631, 0.694354028181587, 0.2521562797973746, 0.7778618844501132, -0.2432102318676288, 0.3433773575769854, -0.1878515737084198, -0.09834879212364028, -0.8121767199607324, -0.4776512127118383, -0.3882311488442241, -0.39142864909788094, -0.23845428532082094, -0.6777412384056299, 0.27716309794261285, 0.6842382936690116, 0.38494172866760523, 0.24226358486735433, -0.3814830971310085, -0.30896618777896695, -0.30075624032358106, -0.43673717948554913, -0.3234410650959117, -0.10942116537089012, 0.37211408660088774, -0.10195797833327534, 0.37696872776150486, 0.4656807962618619, 0.09099829849653485, 0.682742680554348, 0.19661435289264334, -0.08063212208656698, -0.059972983755556916, -0.16574075492625945, 0.17871707218456317, 0.02286753526605097, -0.07986041625793158, 0.5009958194484608, -0.30434481679101344, 0.5324626907820282, -0.5844749781860809, 0.07754546722327166, 0.18643364009416682, -0.695012824872718, -0.03865893528730062, -0.4720925739555943, 0.256324730437549, -0.33011758607429054, -0.21990199349437012, -0.9016385459374093, 0.4667631424319944, -0.6053772116065373, -0.21642873724281494, 0.05312812937059577, 0.015264426183287154, 0.45329597653882725, -0.005648185640889375, -0.6506566619184894, 0.7998520743528038, -0.7918543486951458, 0.7936496115096932, -0.645254837171992, 0.5073260434799484, -0.327801269610074, 0.7295539793184077, 0.5884533492195271, 0.8689725923858506, -0.8108611544662104, 0.030684402159898802, 0.801490202516468, -0.7242928828744976, 0.6833400376501885, 0.19905196551377247, 0.052482922233024726, -0.21853093728697673, 0.6983698570269095, -0.31474595815517936, 0.494504204781479, 0.5186943886613942, 0.4459846933779096, -0.2336653856206486, 0.2750920876348561, -0.17380447431525653, -0.27915967080116416, -0.038395032322739095, -0.23833584693354043, -0.7990975207248602, 0.853484554319232, 0.41134036175603583, -0.8655578050099784, -0.8882599358640029, 0.2046740807482676, 0.6801658261045858, -0.2294912261021568, 0.9019490042339641, -0.8783531279369307, -0.07478493941144233, -0.04447394307659494, 0.7098888196363026, -0.46973333215313373, -0.7253868091088083, -0.1701639761529667, 0.14819250643783238, 0.9356608142504799, -0.724947844209108, 0.5021288477357808, 0.29645681047387873, -0.37902020481648774, 0.6327993324094756, 0.39159815500936623, 0.09990898129674441, 0.5984538951968341, 0.46071113817183185, -0.85216030784974, -0.09783528730212826, -0.6640311023136738, 0.5033606465852509, -0.4371876934991464, -0.31745591079800944, -0.5252320992510195, 0.11450352475886616, 0.002964818638561892, -0.5376725933735619, 0.05159132323143095, 0.5691669872828714, -0.31027153305657657, 0.09333558880167724, 0.5066410528586692, -0.2190423835017182, -0.07983479891867389, 0.4017789980505963, -0.1918215838716678, -0.2453247619576326, -0.1306201939199857, -0.36505611886896805, 0.33646313334325423, -0.04012450469777034, -0.3361055234523155, -0.29705862022330753, 0.3116894913058739, 0.11121543557276824, 0.9140637802067012, -0.008602307017357355, 0.3063374872763158, -0.5894696545278, -0.5682883227297729, 0.41649897065907276, -0.5168398000148076, -0.6895244166180955, -0.050465732869304614, 0.34204099648216785, -0.04944382789290494, -0.30650369657481397, 0.17171593121486112, -0.22864739431687425, 0.4640968626458863, -0.5020163803653446, -0.30910284811527583, -0.015684513419162424, 0.024733287970596554, -0.8197486623066147, 0.19877869387573355, -0.10027551606993813, 0.2431072271312923, 0.2991315268549207, 0.2945432597510325, -0.7919400573104306, -0.1604585649912308, 0.17010207274643466, 0.33822079496562557, -0.009384769253795153, 0.4178116522163829, -0.3071730155171063, -0.129864234706384, -0.449249812522101, 0.18458484868985012, 0.6387534383415259, -0.5767102603255381, 0.6340865057180044, -0.27966538625831, -0.7623218761445842, -0.6816972480744556, 0.5038096798478671, 0.8301751001798083, -0.40226256535721827, 0.6069188652157437, 0.6396760993648944, -0.11008721577899112, 0.6971808933785744, 0.3083200325890779, -0.11562513496324826, 0.875970574482388, 0.6145682866660186, -0.5052064774303765, 0.30506605516698304, -0.44816915645474853, 0.6096339003891046, -0.6468899413771368, -0.07486306962727662, 0.04302293698071541, -0.13558965992604408, -0.38478846789508486, 0.8592763268283671, -0.34497873016092295, -0.7851320370373969, -0.6828733948486345, 0.8458872660544774, -0.8945292280723718, 0.14474507208960885, 0.4530004429788818, -0.6904898662322446, -0.3066220302859138, 0.2705370297103119, 0.8088296890894111, -0.25632875269788485, 0.556762259420842, 0.6392822978456303, 0.7465714707101795, 0.28619008388574363, 0.47614092261502694, -0.19741121325215114, -0.24281243183678464, -0.3152292301855136, 0.712705765276075, 0.8482834665646161, 0.28546249190475426, 0.8524074187898588, -0.759082336384269, -0.03108327917730446, -0.7706333726048071, -0.29616192080830805, 0.20997777985720367, 0.806786498673205, 0.7344478894044891, -0.464237474174291, -0.7457113245539039, 0.015244865203002157, 0.7285330669459101, -0.23017073704425728, -0.6016527472743626, 0.8197893611867587, -0.3815631043361628, -0.4215028078560382, 0.06336102051379146, -0.7654870959301643, 0.3902579195694217, 0.06244477958105764, 0.4918276258428415, 0.11405174778618973, 0.8030955479658619, -0.03513259726500724, 0.7795455823889901, 0.6763238354132813, -0.4624184476412936, 0.23467932103869543, 0.34588254832691134, -0.16546899466847192, 0.02790508171453516, -0.08330223819600054, -0.7167163163757517, -0.274721447868058, -0.21944024994322114, 0.3129372276521839, -0.3666436853375314, 0.9434203374713019, -0.6572737394446518, -0.49807506391429923, -0.20195042211932743, -0.5447150707253946, -0.35832177150713607, 0.7390166691133396, -0.10619825995929127, 0.5599485757130248, -0.45493049574245054, 0.22971260461491652, -0.16737714976959545, -0.39974578406244193, -0.4739906429259746, -0.17684252654445223, 0.08548008122889952, -0.9018177274954023, -0.1728129657479553, -0.43741872742034665, -0.6601712028456759, -0.5839896008497413, -0.2735106696009982, 0.262236116936832, 0.043979017849306315, -0.3538382003977232, 0.23522067108005074, -0.22975490453697328, -0.15174517302105484, 0.27095121500536473, -0.24322283484209467, -0.10482136845175909, 0.66093138459608, -0.1387171703840536, 0.5852348870070885, -0.583083358415627, -0.3444774671906713, -0.17476867567650875, -0.8785875328519734, 0.2821905922754183, 0.6936710931231047, -0.17566491941516277, 0.1509106819289393, 0.13020126831191006, -0.5414715162360861, -0.5336238429433164, -0.7800278658829064, -0.018111888599649587, 0.14601079356431831, 0.5345789754423295, -0.29593400901503825, -0.11514329727701322, -0.04293387644544578, -0.7353651996651811, 0.5754459474768797, -0.016095722923766886, 0.17965453821271177, -0.15445617223630936, 0.7765441797341993, -0.5714045544568963, 0.1995672585880805, 0.3969314645454651, 0.12046876756778682, -0.2844737392280655, 0.6894604622125684, 0.31213683337984455, -0.4384107528068267, 0.48948615588002575, 0.029563065436007695, -0.5515982396541639, 0.743332226808642, 0.019884228049914403, 0.007479435788330498, 0.6211229844931964, -0.6529976284050237, -0.04228825059321162, -0.14815229965057902, -0.14296584490627284, 0.297244442266454, 0.137857516150308, -0.9410589479006538, 0.13688434861029253, 0.5045554890860255, -0.43819257572414877, 0.319342698875894, 0.3351687286381548, -0.7319542364782152, 0.21831465748819034, 0.7652263946130975, -0.8073045739021791, -0.6003709197067691, -0.8362744094600343, -0.12699147510846387, 0.2958747888890646, 0.32521541952793415, 0.2127797942241091, -0.4535055137522451, 0.12359403175852071, 0.17021348507500925, -0.22827628697744565, 0.05294031552262783, -0.2146703413972445, 0.6519977016869724, -0.8990815666057872, 0.32483524700482735, -0.6612683852023019, -0.7437031120691163, 0.19843470964332494, -0.43803832082283106, -0.3070407604299643, 0.8175170076976016, -0.2099954876613133, 0.026161021871702987, 0.3342664762663546, 0.741670855182499, -0.6505318411681686, -0.42595498408485644, 0.5926497202676829, 0.06789238054480413, -0.9117488774738852, 0.2782220509801545, -0.7299559981848062, -0.2562846316483562, -0.6705980017306077, -0.28141665187690584, -0.09358237049903184, 0.8750496214467925, 0.0219039001973668, -0.7986317142416519, -0.49717584908090456, 0.27291407707418563, -3.4426920209006465E-4, 0.8828762232952664, -0.8565886690856004, 0.6102062021484552, -0.3085754877070994, -0.03793507356055936, 0.3529961580215083, -0.30413949227900156, -0.3641168538136332, -0.1363390082620361, -0.047711469113175725, -0.14295625907883094, -0.05119853417075732, 0.594683680010742, 0.47455808673474115, -0.3674152994758518, -0.691050224180571, 0.19839623237154905, -0.5569603043799032, 0.12571838913538047, -0.6500304548617803, -0.09732657942081889, -0.1247698649395863, -0.5741567335696771, 0.4540467926640117, 0.35656587688209057, -0.5091126964950755, -0.323056764636673, 0.19917866254435615, 0.7197265544417467, 0.29192463640039357, -0.10568325130408733, -0.48207235654244773, -0.8120742601825418, -0.09065669807371918, -0.24205250892386437, 0.1575226391342979, 0.08141606462205009, 0.02923265767775495, -0.4702664918442507, -0.5208934879803997, -0.18683423889155693, -0.4550222872231685, -0.0979214067735217, 0.6233774269349239, -0.03372854986947519, -0.9026528293119284, -0.22243877492501307, -0.1205411210894785, -0.024340995017263178, 0.2752771505853369, 0.09378761459566169, -0.3458073525938221, -0.31474952669018125, -0.25235258946298966, -0.017783228714623484, 0.42994956900840914, 0.46790911286802533, 0.05069127312216305, 0.15556175744632042, -0.5317591739047322, 0.08970361860786749, -0.1678552426396224, 0.38625410823108614, 0.5041834305311645, 0.4546173011710011, 0.2258997553687466, 0.6637825488945441, -0.05241037380611982, -0.5884562853723634, -0.133139651051635, 0.2644838166231656, -0.25581922891961545, -0.6781173266803424, 0.05026949926858422, 0.4558793341568522, -0.5837338351435488, 0.18952089507312123, 0.34168031085097983, 0.1597292043201957, 0.08407648152927405, 0.6887694280160688, -0.08799714033143032, -0.18683504268310053, -0.2835549417707588, 0.13718764295807373, -0.548583310613958, -0.6371989854145165, 0.0780764106620504, -0.28617100033843995, -0.591427598135088, 0.31335453795291546, 0.42221866443320333, 0.5622957312735143, -0.37148345826429136, -0.412127308410141, -0.3804717779787516, 0.5371364250207536, 0.3520122781449831, -0.5822844313063047, -0.01017499580460883, -0.16308062304965673, 0.5245043682482976, 0.33014301813121355, 0.5195888827068501, -0.5018897807519784, -0.3044560688864974, -0.22248624027535793, 0.007664508848647781, -0.3407482901587273, 0.7356596915071602, -0.54098177258079, -0.495052461758238, -0.12981783004550432, -0.03500648549549013, 0.711043859382358, -0.5698485377145913, 0.39290323683259576, 0.7233183756069327, -0.9411491952110712, 0.34862003072574604, -0.508988787404623, -0.11047117367594685, 0.4390349655452883, 0.22416505202975834, -0.060155309297333565, -0.4689383273544101, 0.6163474254018384, 0.048040073066498004, 0.07083440452447307, 0.652130191784741, -0.43901895895100973, -0.1829187910370367, 0.13639885856783723, -0.3299755533200819, -0.047092572863929386, -0.7502847759455129, -0.2699917628525542, 0.06246900262888327, -0.027938733089385503, 0.19374706223885152, -0.692030682183782, 0.16182695314421278, -0.22445557304667924, 0.5933564817459932, -0.43258393311322846, 0.3233843791894252, 0.5418213929059328, -0.5431558629014565, -0.02938871562562491, 0.0656211014771781, -0.47081442539048163, 0.04026441788369607, -0.19348401788726716, -0.46700250913346314, 0.5575563527964768, 0.04511208203248064, 0.1763075455135723, -0.6697516505998367, -0.04141736729583251, 0.46574995371822314, -0.010306985244076847, 0.08149386906872427, -0.6724935888541923, -0.6207266573793754, -0.6715012179052899, -0.2674230812565055, -0.025700536871957065, -0.3073083733716242, 0.7564027994864329, -0.2806080035026724, 0.014937604097738647, 0.6466984087888266, 0.1278305712279455, 0.888774691575634, 0.6458508880358786, -0.01932224085968823, 0.39952136900845453, 0.1503924420755254, -0.4575634044775059, 0.2816901468903381, -0.1710995137415964, -0.009798846085071266, -0.3169362801902892, 0.5692334771708805, 0.581255475544393, -0.4191045589112222, -0.48882912121801453, -0.35096160184048913, 0.7730425285805259, -0.6551239609266462, 0.7439273102789447, 0.005624331321035299, 0.18116046487389695, 0.5722690102654768, -0.703937874733783, 0.3580098736692322, 0.14005968389508855, 0.4125132557541082, -0.1882655895488107, 0.9045898353990557, 0.06154937993414921, -0.7966706494009717, -0.09418902776726944, 0.5253008662958432, -0.10150172143214908, -0.742098777330121, -0.40229407191882544, -0.5393741144910045, 0.21990495875242394, 0.07749641750343003, 0.4465656558813558, -0.36940283616756636, 0.10178927419096959, 0.32066663816084284, 0.5178973721978, 0.028615690158198773, 0.7776596477204761, 0.3853247574252796, -0.144348146631707, 0.08457080050777849, -0.222892058620206, 0.4657333300089148, 0.12058188500708115, 0.4963877453297254, 0.43792546190110276, -0.12020888493152243, 0.27435049490161084, 0.8742637467084253, -0.3734500982530091, 0.038992446417272716, 0.5401392722303399, -0.35774584078592775, 0.3949759341207668, 0.5206954781631216, -0.03933041646042887, 0.23634332731006924, -0.07778529334072601, -0.46720482793975693, 0.3949479393846441, 0.1598093350937893, -0.22255695021820301, -0.5838449158275133, -0.5340005645764047, -0.2383083439266655, 0.07373626571516669, 0.48343365217398004, -0.26681981669022065, 0.816375281593233, -0.12231112499251351, -0.7037542196431843, -0.18883941031858645, 0.043356304929656836, -0.08348050529371781, -0.4951609365222929, -0.6287386180669675, 0.5046691778073736, -0.4494469388541436, 0.44087404694861787, 0.6482640472335244, 0.36317542333935715, 0.19444893871393967, 0.41870018848598495, -0.21352608989530894, 0.0465513094345646, -0.41163085732289706, -0.13674013001125174, -0.27696755334615686, 0.12767367921203618, 0.11541561560266048, -0.24786608012040334, 0.23582155180828204, 0.14024363299922094, 0.17276890801165773, 0.175205121281864, 0.346969385411723, 0.041282116763153194, 0.057835374341540895, -0.1324781315569026, -0.3073531631330343, -0.32420490575125804, 0.16361535369132088};

		w->Set(w_c);
		//w->Randomize();

		//////////////
//		for(int ii = 0; ii < 10; ii++) {
//		double fitness = 0.0;
//		for(int i = 0; i < 3; i++) {
//				srand(time(NULL));
//
//				b2Vec2 gravity;
//				gravity.Set(0.0f, 0.0f);
//				b2World* world = new b2World(gravity);
//
//				S_Field::Configuration sc;
//				sc.World = world;
//				sc.TimeStep = 0.02;
//				sc.MaxStep = 9000;
//				sc.PoisonRadius = 2.5f;
//				sc.PoisonDensity = 0.48;
//				sc.Robot = 50;
//
//				M_M0 monitor;
//				monitor.penalty_goal = -1.0f;
//				monitor.penalty_boot = -1.0f;
//				assa2d::SceneMgr* scenemgr = new S_Field(&sc, w);
//				scenemgr -> Run(&monitor);
//
//				delete scenemgr;
//				delete world;
//
//				fitness += monitor.GetFitness();
//			}
//			fitness /= 3.0f;
//			std::cout<<fitness<<std::endl;
//		}
//		exit(0);
		//////////////////


		srand(time(NULL));

		S_Field::Configuration sc;
		sc.TimeStep = 0.02;
		sc.World = m_world;
		sc.Robot=50;

		m_scenemgr = new  S_Field(&sc, w);
	}

	void Step(Settings* settings) {
		std::cout<<m_stepCount<<":   ";
		Test::Step(settings);

//		for(int i = 150; i < 152; i++) {
//			std::cout<<static_cast<S_Field*>(m_scenemgr)->m_robot[9]->GetDataPool().Get<float>(i)<<", ";
//		}

		std::cout<<static_cast<S_Field*>(m_scenemgr)->m_nest->GetFoodCount()<<", "<<static_cast<S_Field*>(m_scenemgr)->m_nest->GetPoisonCount();

		Draw_W();
		std::cout<<std::endl;
	}

	/// Draw Nests.
	void DrawNest(float a) {
		m_debugDraw.DrawSegment(b2Vec2(-a, -a), b2Vec2(-a, a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(-a, a), b2Vec2(a, a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(a, a), b2Vec2(a, -a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(a, -a), b2Vec2(-a, -a),
				b2Color(0.8f, 0.8f, 0.8f));
	}

	void DrawCircleNest(const b2Vec2& center, float32 radius, const b2Color& color) {
		m_debugDraw.DrawCircle(center, radius, color);
	}

	/// Implementation function.
	static Test* Create() {
		return new Replay;
	}

	//////// Draw
	void Draw_W() {
			b2Vec2 w_v[10];

			w_v[7] = b2Vec2(24.85282f, 60.0f);
			w_v[6] = b2Vec2(-24.85282f, 60.0f);
			w_v[5] = b2Vec2(-60.0f, 24.85282f);
			w_v[4] = b2Vec2(-60.0f, -24.85282f);
			w_v[3] = b2Vec2(-24.85282f, -60.0f);
			w_v[2] = b2Vec2(24.85282f, -60.0f);
			w_v[1] = b2Vec2(60.0f, -24.85282f);
			w_v[0] = b2Vec2(60.0f, 24.85282f);
			DrawSolidPolygon(w_v, 8, b2Color(0.8, 0.8, 0.8));

			// walls
			DrawSegment(b2Vec2(24.85282f, 60.0f), b2Vec2(-24.85282f, 60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-24.85282f, 60.0f), b2Vec2(-60.0f, 24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-60.0f, 24.85282f), b2Vec2(-60.0f, -24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-60.0f, -24.85282f), b2Vec2(-24.85282f, -60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-24.85282f, -60.0f), b2Vec2(24.85282f, -60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(24.85282f, -60.0f), b2Vec2(60.0f, -24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(60.0f, -24.85282f), b2Vec2(60.0f, 24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(60.0f, 24.85282f), b2Vec2(24.85282f, 60.0f), b2Color(0.0f, 0.0f, 0.0f));

			// nest
			DrawSolidCircle(b2Vec2(0.0f, 0.0f), 15.0f, b2Color(0.65f, 0.65f, 0.65f));

			// robots
			for(auto robot : m_scenemgr->GetNodesByTag(MAKE_TAG('r', 'o', 'b', 'o'))) {
				b2Body* bd1 = static_cast<A_Robot*>(robot)->m_motor[0]->GetBody();
				w_v[0] = bd1->GetWorldPoint(b2Vec2(-0.25, -0.1));
				w_v[1] = bd1->GetWorldPoint(b2Vec2(0.25, -0.1));
				w_v[2] = bd1->GetWorldPoint(b2Vec2(0.25, 0.1));
				w_v[3] = bd1->GetWorldPoint(b2Vec2(-0.25, 0.1));
				DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));
				b2Body* bd2 = static_cast<A_Robot*>(robot)->m_motor[1]->GetBody();
				w_v[0] = bd2->GetWorldPoint(b2Vec2(-0.25, -0.1));
				w_v[1] = bd2->GetWorldPoint(b2Vec2(0.25, -0.1));
				w_v[2] = bd2->GetWorldPoint(b2Vec2(0.25, 0.1));
				w_v[3] = bd2->GetWorldPoint(b2Vec2(-0.25, 0.1));
				DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));
				b2Color col(0.0f, 0.0f, 0.9f);

	 			DrawSolidCircle(static_cast<A_Robot*>(robot)->GetMainComponent()->GetPosition(), 0.5f, col);

				if(robot->GetId()==9) {
					m_debugDraw.DrawCircle(static_cast<A_Robot*>(robot)->GetMainComponent()->GetPosition(), 12.0f, b2Color(0.4,0.9,0.8));
				}
			}

			// resource
			if(m_scenemgr->CountNodesByTag(MAKE_TAG('r', 'e', 's', 'o')) > 0) {
				for(auto resource : m_scenemgr->GetNodesByTag(MAKE_TAG('r', 'e', 's', 'o'))) {
					b2Color col;
					if(resource->GetFlag()==0) {
						col.Set(0.25f, 0.55f, 0.0f);
					} else {
						col.Set(0.9f, 0.0f, 0.0f);
					}
					DrawSolidCircle(static_cast<Block*>(resource)->GetPosition(), static_cast<Block*>(resource)->GetBody()->GetFixtureList()->GetShape()->m_radius, col);
				}
			}
		}
};

#endif /* REPLAY_H_ */
