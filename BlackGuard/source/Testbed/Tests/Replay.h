/*
 * Replay.h
 *
 *  Created on: Jan 14, 2015
 *      Author: wei
 */

#ifndef REPLAY_H_
#define REPLAY_H_

#include <iostream>
#include <fstream>

/// Simulation entrance.
class Replay: public Test {
public:
	Replay() {
		ANNWeights* w= new ANNWeights({22, 20, 2}, {false, true, false}, {false, true, true}, true);

		double w_c[] = {-0.7081087428898054, 0.8286047651442514, 0.714949558443044, -0.2397649758784443, -0.6525366716914688, -0.5218871461952769, -0.04453454736220941, -0.8955466998636306, 0.17455160339777434, -0.31741543882795653, 0.38687289179699674, -0.6667616651302097, 0.3935852577611858, -0.11083502477284249, 0.4695428841736983, -0.6286278816110304, 0.13904231589630497, 0.12903562532828902, -0.32386298068442676, -0.14428603203765175, -0.5895416050915544, 0.5787309227199245, -0.15925901554654256, 0.4243326504487683, 0.1612033877827977, -0.5562435454501258, -0.3492345618812953, -0.5525378066495116, -0.4890313039358186, -0.3618961834146976, 0.08473103528514414, 0.38806678379277537, 0.6585163477154228, 0.6588529524500994, -0.0426769054773012, 0.014460218118651533, -0.10937539782994131, 0.44693364217022635, 0.29348908896904086, 0.05937970343390814, -0.3650030368912822, -0.28640313756194785, -0.47926107434247645, 0.10110907383004784, 0.4289811572905063, -0.04892150605446058, 0.6663341798863541, -0.7806696190261986, -0.5306076432687968, 0.6435611197146096, 0.4310722422637973, -0.2478779524610241, 0.09847273153587603, -0.10943649547323385, 0.21669272259465616, -0.2951969594415582, 0.2228292199421379, -0.5213138284191481, 0.514880284799663, 0.46076456326802895, 0.1887028048086451, -0.2122146348794032, -0.514166323540675, -0.08586735217080163, -0.30191493961696797, 0.24768751253654764, -0.055395932272365216, -0.5543218166253834, 0.6491082248785948, -0.3797691777723242, -0.3079443740682848, 0.26736303504486747, 0.5840275320953585, -0.3383262634260778, -0.3576573800705074, 0.6551850994818428, -0.11573837472987047, -0.5462074121201209, -0.44349276704143653, -0.5739347720435719, 0.21964079417982932, 0.19780152034176235, -0.334893456705313, 0.3319351386603342, -0.3402275798969312, -0.3368810613535962, -0.158991110611552, -0.07232285574899376, 0.11218248170022847, 0.08300788555393664, -0.475752666034038, 0.27192710057797337, 0.10591223093643132, 0.7778838217737741, -0.021346199948963838, 0.5321073918103687, -0.3483180474286403, -0.3340297011836948, -0.15524474282926864, 0.08625653585593335, 0.027819344476658167, -0.3263640752381654, 0.19859852719874244, 0.6560257295654751, 0.0020928984293749064, -0.12606066145691183, -0.013351550133892054, -0.1918289903383567, -0.4366616548185637, 0.438245238087022, -0.35756766007772217, -0.4244589430971555, -0.45037330913794316, 0.14601147338758258, 0.43478589775180637, -0.6882341337089517, -0.1598554373890158, 0.12153406739421291, -0.43716898630948847, -0.24685695971777338, 0.4816535863347474, -0.017436823499092934, 0.0705351931092423, 0.09334774401934041, 0.5557417033869598, -0.48205694034426955, -0.8747230849815951, 0.11652862973825515, -0.016296728407105637, -0.5853412168357284, 0.29375755590006736, -0.16473755026775205, -0.4936855224471019, 0.2278905206807196, 0.24403734662866364, 0.17504991924891697, -0.029786523148785105, -0.4106684652326452, 0.10226335353726404, 0.3945071432113272, -0.26310694841299054, -0.23845372622554728, 0.24473471074536302, 0.6706934193136498, 0.43467828311914747, -0.7379800687096028, 0.21505512686673747, -0.609690395438797, 0.16021949774459665, 0.1291732102550955, 0.47534256514626827, -0.6509334057949963, 0.7069528034317188, -0.5454712015635441, 0.34094154763400397, 0.12317341039357135, -0.4066022289228962, -0.48416843443286783, -0.07572381613122794, 0.3790075297256209, -0.1715169776790434, -0.06038044652747376, 0.49054826016826863, 0.141285112799187, 0.07088596726417372, 0.09595156550845657, -0.32477404329823023, -0.0950062973322242, -0.45288073192585915, 0.126102466067565, 0.6357251961919362, 0.0140748023497302, -0.3290664943057121, -0.37611221567451036, -0.2915846045948558, -0.04497494139924127, -0.06725303440795934, -0.42231017642747204, 0.25648693223970587, -0.3084240290389981, 0.5168401618983982, 0.014392754586280698, -0.23585177880206126, 0.17965568633050685, 0.11263775370819652, 0.7401766344384744, -0.13610011073580763, 0.4331197648517954, -0.06752568025072972, -0.760073773734007, 0.13879969114815294, 0.45028859988910125, -0.6442999138783112, -0.3234769842325069, 0.06945164589249497, -0.0579589557791094, 0.44384441517354306, 0.6510956308866325, 0.14938538246061814, 0.5203445051307097, -0.28990923100051963, 0.09189263353474114, 0.17386788033405304, -0.33337355595696455, 0.2870100467973079, 0.10982804008633641, 0.03816538101941417, -0.06266675604908249, 0.3133624954876916, 0.16958788278787673, -0.12026246026281454, -0.26075028335084216, 0.238262509832668, -0.07022147753777912, -0.195171474037691, -0.42530373315362496, -0.14127188658639891, 0.07057414783181787, 0.11280571626974492, 0.3602423700311684, 0.03014941156807202, -0.18202205069448912, 0.30405816622762294, -0.14545134195309625, 0.05005092846288084, 0.7418014094514038, -0.7110368559679068, -0.049684172643588424, 0.33513313823467783, 0.6724486561176541, -0.40392959238870246, 0.34944412645722717, 0.5962042809079935, 5.764468237147435E-4, 0.2587456452673334, -0.31803484599988585, -0.2200212881580364, -0.2993741763642783, 0.3895778074648996, -0.509851094061257, 0.1902207461144496, 0.26811980113309847, 0.5037810630215654, 0.27260105403673734, 0.6992806161604652, -0.43080151180682835, -0.4537509753038205, 0.3064748555455899, 0.05059380335482281, 0.7638708380583289, 0.30725714468843457, 0.07634981048807121, 0.5222971902559612, -0.564261803583137, 0.2591073055990473, 0.017179630520623684, 0.12089410177147598, 0.10553774687255668, 0.27052740604850456, 0.3077291576856876, -0.5073289355260594, 0.03448930590981951, -0.12911094451487554, 0.6568679568767833, -0.4302614196145873, -0.08306740463957094, -0.030721931220738102, 0.48004773444752435, -0.08709919443805532, -0.2407014143964418, 0.42885775684228433, 0.8031848961857349, 0.2838660491719458, -0.11876427474843926, -0.1865300680182403, -0.6404491197370987, -0.33557971633023703, 0.11319417098058465, 0.3444762584620957, -0.09545676815478407, -0.06829601804904153, 0.2575284063092972, -0.1676214686818865, -0.6184266597794119, -0.46607902285299085, -0.32823850950407896, -0.387302080960197, 0.7489885646629844, 0.4655174867395629, -0.6887993683159078, 0.2998492325903862, 0.09642431037150137, -0.25621824263742216, -0.6442945160619188, -0.5424397828637676, -0.035379794283984606, -0.8402623778153283, -0.8404863250959135, 0.2709509995182, 0.17804861874661074, -0.5352983207177466, -0.629664187316859, -0.7086738664066429, 0.1569548462808369, 0.746549028584642, 0.0072572173497143745, 0.8029470471022908, -0.3825433087889853, -0.38598019332743827, -0.014219407900402006, 0.38579336763976096, 0.05001830895148626, -0.11101099637519753, 0.6521611155122916, 0.8380369294176961, -0.55636360646935, 0.8855724401904356, 0.7853263591848421, -0.6346186579820017, -0.4371411563678781, -0.6918403861931556, -0.6884136641573373, -0.4772221633536392, 0.054802460906248754, 0.7218005484672405, -0.08003839168009828, 0.7109521688443896, -0.7050673766118872, -0.7840558357193459, 0.599050672700747, -0.48165926948076915, 0.628576331009746, -0.05092409212817165, 0.8798939258959941, 0.7389285766956324, -0.8458609938109297, 0.5374863437770577, 0.46413326437876945, -0.7366660794345055, -0.8940245374889968, -0.08792783864666615, 0.021433912505884417, -0.317964384947823, -0.19250238501463876, 0.239377109782386, 0.11485130809159273, 0.18628638829169605, -0.019609720675579465, 0.002752988653315365, 0.07681060095780526, 0.031302825912151076, -0.043245792438794006, 0.17704176979569675, 0.2866040572388745, -0.10564868482121115, -0.045218727462007974, 0.17618751134780236, 0.06759525704589983, -0.5849070436498709, -0.2064042826006082, -0.3716210428161558, -0.11316615934218585, 0.3942386884081207, 0.03233178917109078, -0.244305164100525, 0.36104720036932775, 0.19445507537752826, 0.009549484402820246, 0.1066485040085748, -0.13416975270232223, -0.8430489984263865, 0.0937490416361727, 0.5388684629666334, 0.5610406762866529, -0.43046629840875655, -0.04898516708782434, -0.30839722693255384, -0.2998918978983385, 0.22625192742683348, -0.5354164125824997, 0.003121186648763097, 0.2842354269779927, 0.39542455877773763, 0.6389080047002259, -0.07632108957101388, -0.0231658238528155, -0.047384502399497215, 0.08842067256765947, -0.39506010100719635, -0.6774999569098391, 0.06716295695074256, 0.12365864844872998, 0.12212043754828747, 0.017054446973237866, -0.20482457165825807, 0.2900446686312307, 0.44208294677473436, -0.19797600751400712, -0.17804388040498373, -0.222547248013986, -0.4482295957259903, 0.05840752747994779, 0.27237275049079324, -0.21857862389933508, -0.3287837365788142, -0.8166954643554182, -0.3963466451313249, -0.12536599275528457, 0.5001323608181392, -0.6013967122536449, 0.7753536595336531, -0.3829840803161395, -0.7580029600242355, 0.38638035571900253, -0.554758448367566, -0.771733446109368, -0.6242725963873106, -0.6776055780684017, -0.4705298474028504, -0.5105303850206625, -0.25472169174021914, -0.9434353888503817, -0.3632749589181188, -0.2544207976531642, -0.08387313291060366, 0.5144365267566673, 0.029184446938580078, 0.7398086843166002, -0.2086070293129199, 0.8071526397125414, -0.4525936360950017, 0.025112654418395802, -0.5369613434717811, -0.8428304188550819, 0.4901137511373759, 0.43137708638807915, -0.6941169483579569, 0.6753019307456889, 0.4494796631864605, 0.2946631624808618, 0.22450119793055745, -0.7209325057526264, 0.8414960759351258, 0.17722559455770592, 0.2997794163840715, -0.479849535208355, -0.7972678758745121, 0.31686627818035046, -0.6585285581575717, -0.24852973173084514, -0.10804838511470484, -0.6823854416889045, -0.7168376264477931, -0.042126957173833024, 0.7825976957581496, -0.7414630684999948, 0.5682701137042128, 0.3395961187868632, -0.07669533071926014, -0.386457982593146, 0.26985138653708773, 0.8372474988070233, -0.53386494266112, -0.7492085688404828, 0.7765174562846949, 0.8285485719419389, -0.6465665939069085, 0.5432424739221695, -0.7714923111834381, 0.3976378194617408, 0.8240163469679141, -0.6110990015131842, -0.7920585474599141, -0.12333900655359695, -0.696787892477505, -0.4397854611906613, 0.47572609651445197, -0.47882236594206495, 0.6231669431679601, -0.7735646919732653, -0.5961737293374196, -0.5521390175541329, 0.40131587563493093, 0.3766704853180524, 0.2906023246266381, -0.11525649821613147, -0.7286321957821108, 0.566023058936237, -0.5372863747665566, -0.31659639886288565, -0.32749436634844675, 0.4721220994959746, 0.5964366942667718, -0.3245302175102094, -0.06059088023732245, 0.018631206309214804, -0.17357556503398858, 0.09936418480115479, 0.657819780874348, 0.07368374381727402, 0.19572632596202252, -0.29796940623153745, -0.09662925019239879, -7.947410896451124E-4, -0.6380847595889908, 0.5009075194404624, -0.19659438192182663, 0.49683856148963723, -0.22247797760096183, 0.3351880184390215, -0.19917293163991054, -0.5432568992568175, -0.0967255326562119, 0.03971561480862306, -0.3940907053726377, -0.09010124985187859, -0.25193194481994885, -0.5307037008953682, 0.011872281319183928, 0.2725173787798569, -0.07409637484677828, -0.0026236487192789135, 0.23817328430193258, 0.4375385524818127, -0.11784831892415343, -0.7871256199859479, -0.20877181765885597, -0.5854900066509537, 0.25519478809473006, -0.06082113553300684, 0.4146139833742815, -0.28640467028941596, -0.04478978449310651, 0.09788134508624044, -0.22377363800133876, 0.6740303291475999, 0.46348377275311925, -0.29306972583680346, -0.38703433946135096, 0.1271173942970965, 0.09979939294056242, 0.054920917452307705, 0.39806363389293314, -0.3490323114184359, 0.16602009270195298, -0.6073378922389245, 0.2769548105742445, 0.050804742194226274, -0.11266578826215064, -0.4805493035610352, -0.022354104839250735, 0.4811845355089068, 0.5582162884594466, 0.15684493432283825, 0.13964429338533246, 0.31886763646062827, 0.5478538552608214, 0.8466352494035879, -0.49506570458086013, 0.042573626457851566, -0.006602470427035156, -0.5006816334234698, 0.34505296222257276, 0.03878960412978985, -0.007909788113753258, -0.22805910701747864, 0.545702876533569, 0.44323379062844004, 0.07548210813422349, -0.0063008240908623, 0.4606532902409577, 0.07895196351231894, -0.6456910067709514, 0.31605338419594264, 0.11250231396589618, -0.5267807787607541, 0.6399187416163922, 0.2540822520825172, 0.14950605572684747, -0.18962411279120045, 0.685708898304929, 0.06163982230489659, 0.6040400626154677, -0.2977129332508692, 0.812605613123124, 0.21565460007831497, 0.2952112843336149, -0.39776448800252434, -0.019378280840052317, -0.03940732489646363, -0.3006558391939966, 0.5185403968534512, -0.2908407022731371, -0.2338224994036102, 0.6947167662206388, -0.21174387289220137, 0.6417864299509248, 0.7103397689520083, -0.1725299753468325, 0.2498315306276181, 0.2015992267846974, -0.36853266036142585, 0.14188924427190291, 0.4216510197206475, 0.3667513428249527, -0.09608417350279674, 0.2689730228795242, -0.046889511481647154, 0.1371468753832283, -0.26065048690064535, 0.2975749520723706, -0.755288449902052, -0.06270306862740213, 0.36881364409968026, 0.5485094932826069, -0.08868922499787012, 0.6392882885859986, 0.7049218051347872, 0.7038686205883801, 0.250693249850115, 0.1814302312168487, 0.6128187207608629, -0.07064554157375555, 0.3294366279017542, 0.03425032730908088, 0.7736403205656203, -0.08691255364729615, 0.5500608446198036, 0.785888565240557, 0.6423248979409879, -0.5380760648779928, 0.4260686223539352, -0.21481048037608988, 0.1726932214489726, 0.27124810118177, -0.28852506821356216, -0.7236701662796734, -0.11749097960122888, -0.09926373712361519, 0.2780172370167909, 0.05242514419478897, 0.10533811813127444, -0.5920730144016945, 0.0212070743922724, -0.6643541322123453, 0.4518054024441635, -0.1457910423195487, -0.4542102564567864, -0.231671020450729, -0.10220568092649604, -0.5915015686883593, -0.0371395143876413, 0.24666522472531172, -0.4930737071367177, -0.25044272936662826, 0.2659082560371455, -0.6604778156366975, -0.19069638378612455, 0.5646746546126097, 0.2201511366960709, 0.40785378994874255, -0.4819114371958616, -0.04769957398534147, 0.3501364276177185, 0.22194486813268302, 0.5335159768422958, -0.1956182702705246, -0.2090561957515011, -0.32593593827051176, -0.3364914693158525, -0.18984084927734501, -0.3158685515362727, 0.5766274289261824, -0.11610256000228089, 0.749177874231489, -0.16790805576777224, 0.012422326830250387, 0.4454502654291568, 0.30580190982296535, 0.10661813936943765, 0.10683299153774636, 0.5729817954500914, -0.019752415843227802, 0.3084812149438016, -0.5717064675259602, -0.3371012660310424, 0.1842079838525858, 0.09976425386747789, -0.5888928393811266, 0.2294303881520904, -0.3271711791564639, -0.4692102344455754, -0.06153868612247734, -0.3839225513770967, 0.07456870394008767, -0.7527612077156539, 0.18559570574092293, -0.21735526251224568, -0.7362228130070363, 0.5836417225003484, -0.5518485302225529, 0.051510562428380764, 0.12829920703875058, -0.014543064535590046, 0.1269949152449921, 0.03990585138410172, 0.3988688572176179, 0.14759059353049067, -0.4427815948510907, -0.048467047410339706, 0.1096788841749316, 0.3494160389653311, -0.3277001996798888, -0.45474269860275335, 0.16243744719949707, 0.48676133039067304, 0.4268990446018289, 0.3410393617869283, 0.08700002690429826, -0.21921254374327098, -0.8775941968020788, -0.039506878289039274, -0.18938739657175974, -0.3457879613975038, 0.417719913987087, -0.38117211983470867, 0.21060459641764936, -0.058582544167362825, 0.1762966964731734, 0.48488509503818267, -0.07163759093230447, 0.44755576820571397, 0.4886265282975839, 0.014975138937964844, 0.3138574022789638, 0.07646485023826183, 0.3751490743268722, 0.6455284930881171, 0.4820896960143528, -0.1010737853228996, 0.07427649640681258, 0.6990959014384626, -0.37044648233273564, 0.5107939436250565, -0.374268896985185, 0.19315198182577198, 0.13697607658862707, -0.7860740464913321, -0.34696223589291886, -0.43010616965778947, 0.08875635570029337, 0.1188676359917752, -0.04491649700241245, -0.5853147943259731, 0.393676022871273, -0.49582290770849874, 0.7472016352225239, 0.2808927187578298, -0.5992412040449061, 0.3956650319047377, -0.19538544953245646, -0.49570910299215254, 0.16216579909516218, 0.23472858881188163, -0.04438481312961559, -0.30058889638282976, 0.227935195503981, -0.8551176005956244, -0.31157417505951635, 0.29390915468649037, -0.5770831526763678, 0.43969024178032173, 0.3059471305440188, -0.11154047688935195, -0.1942067817592201, -0.4971330619297999, 0.3739181169055197, 0.5583203684950269, -0.17794771505733978, -0.293243280992472, -0.269113781991679, 0.5455173352830105, -0.35218136529475863, 0.05633813178471418, 0.5138883034498135, 0.6837326511159416, -0.44116055506920765, 0.4615317932223707, 0.35131390709505594, 0.1263477229016255, 0.019112675932495674, 0.004453610433641911, 0.6943489846185489, 0.3503290344581974, 0.24539794095663914, 0.2106215581107674, -0.566622208307057, 0.17855262357365467, -0.26256766995942254, -0.37828393134661703, -0.07427508832714462, -0.6915791324564228, -0.38200659524740344, 0.552584125797562, -0.4443077048481671, 0.08908766237314952, 0.3369267717545773, 0.5196906836762034, -0.6217232610811104, -0.013379100558814208, -0.1881009912564646, -0.5040310939586758, -0.1966517592944555, 0.2541746546264136, 0.6071086009890185, -0.45953947406258805, 0.9197350797885256, -0.6711860964750227, 0.6269344925357949, -0.6508397091127142, -0.5146374991899929, -0.7248336113151214, -0.3224528817520224, 0.6798109633268681, 0.6105825294136754, -0.08747072132640832, 0.38242258451891126, -0.5050217069625789, -0.9031290418739168, 0.3829292712592631, 0.369347287039215, 0.4760767838538395, 0.6493812064397879, 0.5084326343157394, 0.5382359222374198, 0.4579611605265921, -0.48685999994344603, 0.6870612696028962, -0.7510674590415947, -0.3530485242917875, -0.06296785092339348, -0.2968947606784355, -0.5672255186377279, -0.3983779985993601, -0.05319011140184321, 0.1774401563830507, 0.36512482359521914, -0.14030342066465717, -0.12975975780307694, 0.11363069476742052, -0.09741723439613058, -0.3882797388966145, 0.4435169751568644, 0.1078660364737941, -0.1916065977581244, 0.45273597957871314, -0.1520151685976549, 0.05111477080111548, 0.16000827453295177, -0.3250926514221935, -0.36909764192194316, -0.14068268006245127, 0.047546968713058996, -0.277094209003335, 0.2892701434804631, 0.10050671690561196, 0.04787916377108352, 0.2606626248259669, 0.2271536848918731, -0.22251430155207047, -0.049513284232316754, 0.5908219410054669, -0.003586406773064252, 0.05374192169639313, 0.06230674476402456, -0.17213698297765861, 0.058119493307070474, -0.4295168054808332, -0.5914031405984982, 0.4109086586045033, -0.06475752015743659, -0.053071593610814136, -0.2602768387951821, -0.14275613082158506, -0.21331703603042718, -0.04104398551852938, -0.1780441148934112, 0.0940688941740974, -0.016050167625387905, -0.13842300883093464, -0.08846987933856493, 0.1662505716509747, -0.10514056328297672, 0.31827524261463325, -0.12424222122314384, -0.22680147024197886, 0.0576537548069319, -0.23222337970258808, -0.037789790364888186, -0.18249012552802077, -0.26504123818723, -0.35435500067049336};

		w->Set(w_c);
		//w->Randomize();

//		//////////////
//		for(int ii = 0; ii < 10; ii++) {
//		double fitness = 0.0;
//		for(int i = 0; i < 10; i++) {
//				srand(time(NULL));
//
//				b2Vec2 gravity;
//				gravity.Set(0.0f, 0.0f);
//				b2World* world = new b2World(gravity);
//
//				S_Field::Configuration sc;
//				sc.World = world;
//				sc.TimeStep = 0.02;
//				sc.MaxStep = 9000;
//				sc.PoisonRadius = 2.5f;
//				sc.PoisonDensity = 0.48;
//				sc.Robot = 50;
//
//				M_M0 monitor;
//				monitor.penalty_goal = -1.0f;
//				monitor.penalty_boot = -1.0f;
//				assa2d::SceneMgr* scenemgr = new S_Field(&sc, w);
//				scenemgr -> Run(&monitor);
//
//				delete scenemgr;
//				delete world;
//
//				fitness += monitor.GetFitness();
//			}
//			fitness /= 10.0f;
//			std::cout<<fitness<<std::endl;
//		}
//		exit(0);
//		//////////////////


		srand(time(NULL));

		S_Field::Configuration sc;
		sc.TimeStep = 0.02;
		sc.World = m_world;
		sc.Robot=50;

		m_scenemgr = new  S_Field(&sc, w);
	}

	void Step(Settings* settings) {
		std::cout<<m_stepCount<<":   ";
		Test::Step(settings);

//		for(int i = 150; i < 152; i++) {
//			std::cout<<static_cast<S_Field*>(m_scenemgr)->m_robot[9]->GetDataPool().Get<float>(i)<<", ";
//		}

		std::cout<<static_cast<S_Field*>(m_scenemgr)->m_nest->GetFoodCount()<<", "<<static_cast<S_Field*>(m_scenemgr)->m_nest->GetPoisonCount();

		Draw_W();
		std::cout<<std::endl;
	}

	/// Draw Nests.
	void DrawNest(float a) {
		m_debugDraw.DrawSegment(b2Vec2(-a, -a), b2Vec2(-a, a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(-a, a), b2Vec2(a, a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(a, a), b2Vec2(a, -a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(a, -a), b2Vec2(-a, -a),
				b2Color(0.8f, 0.8f, 0.8f));
	}

	void DrawCircleNest(const b2Vec2& center, float32 radius, const b2Color& color) {
		m_debugDraw.DrawCircle(center, radius, color);
	}

	/// Implementation function.
	static Test* Create() {
		return new Replay;
	}

	//////// Draw
	void Draw_W() {
			b2Vec2 w_v[10];

			w_v[7] = b2Vec2(24.85282f, 60.0f);
			w_v[6] = b2Vec2(-24.85282f, 60.0f);
			w_v[5] = b2Vec2(-60.0f, 24.85282f);
			w_v[4] = b2Vec2(-60.0f, -24.85282f);
			w_v[3] = b2Vec2(-24.85282f, -60.0f);
			w_v[2] = b2Vec2(24.85282f, -60.0f);
			w_v[1] = b2Vec2(60.0f, -24.85282f);
			w_v[0] = b2Vec2(60.0f, 24.85282f);
			DrawSolidPolygon(w_v, 8, b2Color(0.8, 0.8, 0.8));

			// walls
			DrawSegment(b2Vec2(24.85282f, 60.0f), b2Vec2(-24.85282f, 60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-24.85282f, 60.0f), b2Vec2(-60.0f, 24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-60.0f, 24.85282f), b2Vec2(-60.0f, -24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-60.0f, -24.85282f), b2Vec2(-24.85282f, -60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(-24.85282f, -60.0f), b2Vec2(24.85282f, -60.0f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(24.85282f, -60.0f), b2Vec2(60.0f, -24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(60.0f, -24.85282f), b2Vec2(60.0f, 24.85282f), b2Color(0.0f, 0.0f, 0.0f));
			DrawSegment(b2Vec2(60.0f, 24.85282f), b2Vec2(24.85282f, 60.0f), b2Color(0.0f, 0.0f, 0.0f));

			// nest
			DrawSolidCircle(b2Vec2(0.0f, 0.0f), 15.0f, b2Color(0.65f, 0.65f, 0.65f));

			// robots
			for(auto robot : m_scenemgr->GetNodesByTag(MAKE_TAG('r', 'o', 'b', 'o'))) {
				b2Body* bd1 = static_cast<A_Robot*>(robot)->m_motor[0]->GetBody();
				w_v[0] = bd1->GetWorldPoint(b2Vec2(-0.25, -0.1));
				w_v[1] = bd1->GetWorldPoint(b2Vec2(0.25, -0.1));
				w_v[2] = bd1->GetWorldPoint(b2Vec2(0.25, 0.1));
				w_v[3] = bd1->GetWorldPoint(b2Vec2(-0.25, 0.1));
				DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));
				b2Body* bd2 = static_cast<A_Robot*>(robot)->m_motor[1]->GetBody();
				w_v[0] = bd2->GetWorldPoint(b2Vec2(-0.25, -0.1));
				w_v[1] = bd2->GetWorldPoint(b2Vec2(0.25, -0.1));
				w_v[2] = bd2->GetWorldPoint(b2Vec2(0.25, 0.1));
				w_v[3] = bd2->GetWorldPoint(b2Vec2(-0.25, 0.1));
				DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));
				b2Color col(0.0f, 0.0f, 0.9f);

	 			DrawSolidCircle(static_cast<A_Robot*>(robot)->GetMainComponent()->GetPosition(), 0.5f, col);

				if(robot->GetId()==9) {
					m_debugDraw.DrawCircle(static_cast<A_Robot*>(robot)->GetMainComponent()->GetPosition(), 12.0f, b2Color(0.4,0.9,0.8));
				}
			}

			// resource
			if(m_scenemgr->CountNodesByTag(MAKE_TAG('r', 'e', 's', 'o')) > 0) {
				for(auto resource : m_scenemgr->GetNodesByTag(MAKE_TAG('r', 'e', 's', 'o'))) {
					b2Color col;
					if(resource->GetFlag()==0) {
						col.Set(0.25f, 0.55f, 0.0f);
					} else {
						col.Set(0.9f, 0.0f, 0.0f);
					}
					DrawSolidCircle(static_cast<Block*>(resource)->GetPosition(), static_cast<Block*>(resource)->GetBody()->GetFixtureList()->GetShape()->m_radius, col);
				}
			}
		}
};

#endif /* REPLAY_H_ */
