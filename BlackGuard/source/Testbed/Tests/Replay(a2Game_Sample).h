/*
 * Replay(a2Game_Sample).h
 *
 *  Created on: Jan 14, 2015
 *      Author: wei
 */

#ifndef REPLAY_A2GAME_SAMPLE__H_
#define REPLAY_A2GAME_SAMPLE__H_

#include <iostream>
#include <fstream>

void Draw();

void DrawSolidCircle(const b2Vec2& center, float32 radius, const b2Color& color);
void DrawSolidPolygon(const b2Vec2* vertices, int32 vertexCount, const b2Color& color);
void DrawString(int x, int y, const char *string, ...);
void DrawString(const b2Vec2& p, const char *string, ...);
void DrawSegment(const b2Vec2& p1, const b2Vec2& p2, const b2Color& color);

class Replay_a2Game_Sample: public Test {
public:

	Replay_a2Game_Sample() {
		//ANNWeights* weights = new ANNWeights({28, 20, 2}, {false, true, false}, {false, true, true}, true);

		//double w[1022] = {-0.4873244263035567,-0.40969297562034185,0.626995703993289,-0.444796659668312,-0.7899800455565201,0.8736766279545828,0.4580253885225426,-0.06056890814411301,-0.5948597420972971,-0.4893092804463266,-0.2701345894532133,0.41640366993528083,-0.6493513729406757,-0.8158820312539312,-0.07863327325144873,0.4215481368363194,0.05544442965833595,-0.8989625148992914,0.7020458345275045,0.24132014811658467,-0.952883450358973,-1.0,-0.5099499039856011,-0.5982321849735655,-0.0294610067031216,0.7380217340165011,0.16052738527405877,-0.6466620807511079,-0.23542930174399185,-0.6474394912285513,0.5060978685749865,0.21726789648843078,-0.9962959430230297,-0.4925286059998317,-1.0,0.29925132305122765,0.8582353239996464,-0.3981449980810854,-0.35492443801277285,-0.5334943211557323,-0.6350751818336741,0.17436891524451234,-0.9276094038521541,-0.21986231323514607,0.8952417211010856,-0.9141464117500623,-0.8116058502822119,0.5581049861483893,0.917468131554947,-0.06849048962037549,0.8385684132482175,0.6134083215498289,0.9511640776663551,0.2959081206701984,-0.3792091385171724,0.0855445108084679,-0.5995057101727902,-0.587673786920829,-1.0,-0.6712203075176579,-0.46794545601971654,-0.20481316591360404,0.4483965473489015,-0.23044041729575435,0.006229270986616632,-0.5804268597986953,0.872694079510472,-0.3800520717546859,-0.7203943860336967,-0.8442840005655328,0.46224869187083906,0.9516914393094948,0.39984717669454745,0.035779641696471076,-0.25168452622500576,0.06822056821864755,-0.021310953130742796,0.9573793350862538,0.5516516672204447,-0.0681604953894788,-0.4337779234161526,0.3764727485286701,-0.26148937268604316,-0.026328492187601336,-0.5867174549404325,-0.02282551066840619,0.6263503885651492,0.05943389019051667,-0.8360728795504113,-0.6015934443685063,0.7920813179285795,0.8628276284198159,-0.6536820103162487,0.4065090904062431,-0.9318467177455138,0.16024309781626467,-0.06988857874561549,0.8675482569899586,-0.8812764162566696,-0.2814910305301076,0.2493034217398467,-0.5588277191430319,0.6741876066379634,1.0,-0.6269168176949598,0.6369144237621115,0.8824682712806174,-0.20167216951205624,0.26488868526270726,-0.0672814530112487,0.4563989010303182,-0.36600523089879317,0.6892476822207071,0.34664219040387884,0.18556139834264196,0.06691304136619175,0.15743532444992536,-0.7681896832333036,0.6963103357854179,0.7070103862677266,0.1317424836993824,0.6045885104155306,0.1297818516470838,0.42618098203089727,0.951336182288957,0.4152238762378574,-0.3554433205500258,-0.6909816711160586,-0.801207621866514,-0.05405515284527229,0.9775495005262115,0.2699326511383923,-0.06449335166208561,-0.25773378788914836,-0.8786150200545709,0.8444199690777984,-0.29980552108801256,-0.6525058730171349,-0.8428206244968656,-0.8228501633887262,-0.1812455474804309,0.2106174650203682,0.2845169403837528,-0.29919665501628834,-0.39512151771636506,0.6734429472552959,-0.1641855223263842,0.9222722095612251,0.5391059481252721,-0.29752262302609206,-0.03005219884467741,0.1831755944939431,-0.33717399755229904,-0.7469022812773372,-0.8741731900437224,0.07926428100682313,0.8534536038676456,-0.19296582683495714,-0.9080457970315363,0.9306649792366364,-0.7162926974598187,0.7712691941431743,0.09213538138525809,0.2871752948244658,-0.5109334971747477,0.5691955726055271,-0.5416081110942441,0.8526874777911627,0.0022881439278753316,0.41380043265441097,-0.8999658123164958,0.2791977556411524,0.6431250374503491,-0.37598916026188994,0.584118784254184,-0.6060858813026544,-0.9994053480340468,0.8645225027734291,0.20562378815413415,-0.015881030535065167,-0.8404220494497837,-0.4620250556412699,-0.7134782734019984,-0.8839001085509541,-0.11318835307393822,0.14067036737136324,-0.6810787283995825,0.8966555210831497,0.06225540822555461,0.8091359459583436,-0.44400768926980083,0.9383608118342273,-0.3529541959048816,0.3946176595465136,-0.341899904575603,0.576930590460849,0.011002974117168296,0.722072759373334,-0.6221004984649495,-0.030748283768091904,-0.38572573636649804,0.8500585449520413,0.5063641847992754,0.48552929720326043,-0.09765986909921191,0.23751794185344788,0.40443459096674367,-0.6878033294185661,-0.5724882126323555,0.34582087108054277,0.9651927970663172,0.1501783025775733,0.11312687637050013,0.18449576606797938,0.47570751898229163,0.6882888813123813,-0.7827597258542704,-0.18276960163784822,-0.8167239767802175,0.2974365578315067,0.024179531926968947,-0.21682662870369435,-0.8320754984290976,-0.45474501911140164,-0.03667397498474575,-0.9651379170319901,0.03785361139058962,-0.7118775372207028,-0.1895781239569453,-0.5418612735077316,-0.1458389844022974,0.2817116112258567,-0.7221074643484036,-0.1861204810925,0.4701007693661941,-0.20524410974703153,0.37629307527210143,0.39629323772737074,0.6877772913393896,0.12510685655482942,0.9688650917553197,-0.9874576409189756,0.08984532491312786,0.6737031300960739,-0.9889211486194344,0.012270293148085146,-0.13463178257869204,-0.3612013649330403,-0.1691729721078969,-0.1326668875254825,-0.6004237553721794,-0.21695892102087516,0.503331656244068,0.8490588777071725,-0.8749443289493876,-0.7569200213233632,-0.5859730267951738,-0.1915322287153798,0.42776599287863326,0.8620752577983415,0.7577351713241942,-0.9066160018521013,-0.28886310037945934,-0.3085226632596356,0.7659306513101032,0.6162078544681406,0.06004456440784073,0.4495489018280061,-0.17793484996233216,-0.5324589010336602,0.7282658522311084,-0.09303696523753335,-0.0684531135066021,0.05969099115474507,0.9101325645332392,0.4175313422547428,-0.042054853241638594,0.47382499246395793,0.2975614207278684,-0.2823053038542917,0.1574779603284683,0.23503337242553546,1.0,-0.7318955781475702,0.10978440859964908,-0.5011876421654385,0.886732299381995,0.7025555404884068,0.024696926211467733,-0.9681065741600875,-0.4996877916935367,-0.7039196188905313,0.7070831458788455,-0.8246458361134383,0.9348920469449059,-0.10781680917902703,0.6013663650290495,0.8433229322716583,0.7771775032265452,0.8496079531648795,0.0568022473421939,-0.011423545612189709,0.7675163360662659,0.4804069899690084,-0.5594725430500077,0.9656742021597253,-0.7698148726827443,0.3097835581409541,-0.9149749594943943,-0.10824913014479046,-0.18178971420899992,-0.314446830775646,-0.9870562045166429,0.7333876131743108,0.667087540502856,0.8027562967107538,-0.7667768585397676,-0.4243858115610938,0.10951641386004102,0.4310164951734654,-0.692903689760401,0.7459172189648462,0.963612698034154,-0.9003330404496536,-0.7821888190691634,-0.7641054070735099,0.9402996475608401,0.4192648238705591,-0.6530021812241323,-0.9761914903242997,-0.7008410000164744,-0.047678213219094094,0.9575207320850474,-0.8903196782134294,0.4682782087792823,-0.6673468358017081,0.8757959989942684,0.8555044981291057,0.851313058057321,0.4954106520364498,0.9110119500979122,-0.9683692774771009,-0.43461040830013586,0.5083808174549335,-0.5198606463912147,0.38576992875624194,-0.1810386200430187,-0.11111275280086864,0.8271833563562977,-0.03814218068178318,-0.39847503761662584,-0.36032505278697896,0.17673036290253238,-0.37865286336130544,0.6377856380369807,0.18299995260718963,-0.6194702776397353,0.9747246751882932,-0.23620331303904446,0.8808558184683237,0.9931821025122861,0.35119664254649907,-0.6771201647648009,-0.49786262024159306,0.010655027802449852,-0.8722028041392712,0.14924344616781154,0.9404431068223508,-0.9285969544784837,-0.6235512302947017,0.24253861560344359,0.9539359706631757,0.19041825520991273,0.26977275849017446,0.4331347587006158,-0.8047883685803309,0.7259889366660692,-0.6013523612598256,-7.932032075873563E-4,-0.359392658569452,-0.6202431494847053,-0.30612454103206643,-0.5758023888633695,-0.6713485904759756,-0.07138693459701645,1.0,-0.25542671373000614,0.011018936503862146,-0.4601189244850626,0.012237717797765033,-0.5258738684203242,0.20318856371569244,0.06763831140938797,-0.6330193558477243,0.48284449318814276,-0.7999737266399766,-0.8219914734879938,0.46069934439456595,0.7057231019982692,0.14576787387496876,-0.8258475312276808,-0.7955978003375909,0.866334224548512,-0.35081082444772044,0.944922717784959,0.36508273062395136,0.1952982786785755,0.2812078567420803,0.040704694797929396,-0.8276748850386583,-0.803703848017248,-0.058706776445995805,-0.7159675664653492,0.1578902000740282,0.1682816534001583,-0.9000650898374131,0.5532994263944089,0.9073204983017784,0.3057561954249107,-0.7749913021404619,0.20874897760055636,-0.8256360874723951,-0.00791048036740048,0.3514975196370224,-0.5064704256253284,-0.801119443767361,0.22511959924601424,0.04418101932077091,0.9279708629372891,-1.0,-0.9620182455227155,-0.6333763266101609,0.2408063152546799,-0.3817104341495288,-0.72770542878742,-0.588013442714058,-0.27680799780292314,-0.5421551153096041,0.640703395329665,-0.8146109957408694,0.437626539674187,-0.32116569237413756,0.7804823672771273,-0.15657708307958135,-0.9965246112996847,0.4789020927294467,0.15203511724078755,0.19593762828944342,-0.1478038028744533,-0.9621305500480469,0.8613066917412834,0.6350841726185127,-0.0919289627758481,0.08937880298647925,0.4382073126153679,-0.9135083798052144,0.8548123805667204,-0.5848448398360039,-0.0711136821323442,-0.322223990401183,0.7956009575496487,0.7421072250564565,0.44894062602344553,-0.19867518067490997,-0.44341262204220616,-0.24447507108449518,-0.8932368556934775,-1.0,-0.1790054204817946,-0.5532689794031646,-0.5072002957936574,-0.721715154745261,-0.17085121132701028,-0.6159858906101294,-0.9629193946988068,0.557880295539769,-0.523401425991804,0.21454098865843235,-0.8633636809091374,-0.5325017956850299,-0.1500197486613609,0.4837325204582096,0.465009892347771,-0.4015302862119111,0.9448200196948783,-0.3911642491603697,0.28977535692035056,0.5197899377534485,0.8275758675084011,-0.49784649729916775,0.43757132198584653,-0.004393064041661912,0.4134598722016368,0.18238720048169335,0.5478937669690642,-0.7390835687759241,-0.08297337160848302,0.01753343853048347,-0.35127911905330345,-0.36000102880926466,-0.43202239430405803,0.16185506302803357,-0.030300259427749714,-0.3925048468039726,-0.5264281600568232,-0.41651686544780525,-0.4148305961593916,0.06616825557905807,-0.2560225068122965,-0.37190055667129357,-0.6801535717709098,-0.6235240298354046,-0.11253162663165167,-0.5464339719443765,0.7510877542777835,0.6878242641403672,-0.31690350666181755,-0.1051957297323835,-0.7957603581713344,0.8103776049346135,-0.5695437403427456,-0.0796848631062432,0.36577871666590484,-0.7336467569122013,0.39799928210047425,0.2519685792198122,-0.3765370075402302,-1.0,-0.2653327675757908,-0.34877724392907655,0.795522378437765,0.703295638619837,-0.46217094244469376,-0.6641461267341304,-0.8418304385913185,-0.25660079612009784,-0.3263618283961268,-0.6960362206443231,-0.751984977677846,-0.9644239638858616,0.06314581805668276,-0.6912937925631428,-0.9196393971317969,0.8963330375836029,0.7916026178043944,0.759838318000988,-0.9423873906266058,0.9064688294107023,0.8290408964246249,0.008849242983714672,-0.6244496449943486,-0.16339634346116438,-0.9889193894022047,0.18248691754424984,-0.224095435242258,0.773476334114118,-0.933169714691306,-0.8403671264211567,-0.15120537788129565,-0.5669141134591333,-0.6512885622134121,-0.10080940583191622,0.5948893562288419,0.5225178770342488,-0.6948113436271596,2.5134236593972936E-4,-0.08498840303887473,-0.8803218864027916,0.1300019738767107,-0.523490996902319,-0.1376892624392426,-0.2918634197311743,-0.6131613186311623,0.631392234995404,0.7000360327459012,-0.9087249680220224,0.38378314499624716,-1.0,-0.28122318568035215,-0.18893160920785856,0.8685729073736144,-0.015319025084658208,0.30462279534057507,0.7033247153387984,0.23449499088599426,-0.7773280064502819,-0.23008827487664613,-0.8831783611171088,-0.39298171114499436,-0.20064734424289105,0.2854360504165548,-0.4623032194844075,-0.6185843124999988,0.7183992602418476,-0.6714057599408696,0.047807956587589545,-0.8695980226303476,-0.03310670854218468,-0.8403205273758528,-0.9625764636758789,-0.950637328892494,0.15347173171124642,0.30643064984264107,0.20194996693892586,-0.8817497607759573,0.9329804742412092,-0.7714089043510532,0.24354454201992226,0.5156941594884247,0.2805950055067666,0.6493193859461384,-0.6360693995619292,-0.0646448412869561,-0.7736517672077285,0.4325554786692271,-0.7931198924770243,-0.5824933400835075,-0.4279147469418175,-0.20261878375894973,-0.20633956504151638,0.728915215094376,-0.9943134995179296,-0.8024669457351133,-0.18292780607555795,-0.8098894247526258,-0.6646507084725212,-0.1172337761917264,-0.3290823158641981,0.018583197612999532,-0.07077482843796126,-0.30963736790919755,-0.7617566762246838,0.35850389860575205,-0.3458583390707899,0.34689803091879723,-0.7081504896019818,0.3458726628899232,-0.37662616414724054,-0.442132829494553,-0.7304865110829513,-0.14583510451297604,0.9831744610129195,0.05067253877467497,-0.6274248397786327,-0.8624233032166467,0.9093013413446064,0.21872003904012244,-0.5576325753746474,-0.6328105027557824,-0.9284162627396534,0.6611902614268584,-0.807623276716243,0.9254833072080597,-0.22483903824685364,0.9396753601153097,-0.8107272030350782,0.06631516900779061,0.5115409666030714,0.23730077070170547,-0.875999779739684,-1.0,0.7669838074757421,-0.9360413926590708,0.9080891610687438,0.6049130650919589,-0.7162747416184596,-0.6991020808153752,0.350093022535947,0.05108714007471725,0.004222710256141245,0.9184244600064995,-0.6590903960592472,0.9283375271017333,0.2450593160662815,0.6879983773411248,-0.34825991794212724,0.7255666404601062,-0.520236585582388,-0.6563465429213374,0.31525022191571833,0.7857191271590802,-0.151966683708939,0.2468854702749998,-0.2902662202384233,0.9592183318850549,0.47924561347039846,-0.6434473125098474,-0.8449077283362799,-0.17975775092687116,0.23394209025518994,-0.5474768981059513,0.2259078830094155,0.07904162829140546,0.6370036017758243,-0.5634532227740701,-0.9137804989448283,-0.6945100081560424,-0.3950799043712387,-0.6500110193668668,-0.9466104048248504,0.57087725464387,0.28880682510888456,-0.29774614336920446,0.9540369449673842,0.09524297940609357,-0.6804888843430685,0.5574482968910673,0.08619721657049517,0.6822428107858196,0.45530174670113266,-0.37150759631390384,-0.7932710440420997,0.46517368542180715,0.939038531007547,-0.2778276763155614,-0.5421847125333727,-0.014467776974886088,-0.500313136347673,0.40304237772812146,-1.0,-0.7312026389271187,-0.04503015603367765,0.967727655088925,-0.8035697706169851,-0.9031259709599984,-0.08636235296341277,-0.9894941128351318,0.9668975235442661,-0.5205784438179205,0.5211526657668258,0.02496082025342028,0.6743647463363477,-0.7010047318285151,0.32772318503104597,0.20642941148253818,-0.8870822575648745,-0.6007358407209081,0.32522191215117907,-0.3354845514387412,0.9926312319766214,-0.5154350860097395,1.0,0.7834609861166215,0.38947593877762376,-0.146252914556619,-0.5340434228822086,0.9473411270250088,-0.8077372279506333,-0.5613661745819067,-0.13318433929421003,-1.0,0.9527326960955608,0.6510775986057302,0.9268807102067653,0.45418262898942835,0.571873243576084,-0.26021394670696446,0.45105794841926344,0.4374710393548961,0.7920528791722207,0.7748366082084892,-0.6364715160349671,0.8532733146251604,-0.4493434504552057,0.4739607121819487,-0.7211561212677884,0.6794105138657668,-0.6441202201304714,0.15518147018208733,-0.9025133769557916,-0.7354196981636276,1.0,0.10345860720732128,0.8046866741828315,-0.4364475746180013,0.5387072321257144,0.3411886821217642,0.6295897564901227,-1.0,0.33953584827891514,0.42805131029104965,-0.27296167462943116,-0.4559057464884827,-0.8955836008906195,0.49200673961605434,0.48214896130030316,0.9333106406152276,0.6039024329662306,0.4439420389957976,-0.18427816387947887,-0.6413867070520262,0.5143572842318014,0.6345099857952582,0.5048652471222577,0.5310144317275969,0.5910302987007532,-0.9061327002768769,0.2563201989820155,0.018864266619032267,-0.7753178420418276,0.7286712785245986,0.7779209819812667,-0.5540518359696536,0.4732648376002685,-0.4758949521784168,-0.2456544450142124,-0.3624988395918998,-0.0770977789296438,0.8431650800023837,0.012968319454621399,-0.6095357618090916,0.35054972348752766,0.585807387617329,-0.20311904944955933,0.5570500999504162,-0.8991859556706266,-0.3609128859125748,-1.0,0.08137795787690805,-0.9142723896414731,1.0,-0.29725054507145127,-0.3439916192658839,0.49331850738252464,0.8504222355516693,-0.4265424640505926,0.2588563870714613,0.782287034207067,0.2805981951567472,0.8073925071999033,-0.8694414543557423,-0.6676456293512623,-0.3011223746042029,0.6683385635850256,0.633069561675964,-0.8144140262878163,-0.4868925069845279,-0.7527175397656239,-0.4804053955740616,0.2255229432011578,-0.8591839142418549,0.18505238845728092,0.9040458846216721,-0.2767280649343807,0.43172675435862007,0.8838055863307966,0.7686299604082578,0.1009900672717183,-0.44444414167532165,-0.5998016338806251,-0.39054681226844806,-0.8617447541104756,-0.9400328537101666,0.9845317463033572,-0.5423619753516982,-0.8449029276737691,0.9725022071053416,-0.04560037666902327,-0.7850418920995575,0.7082132822974097,0.1317843627760442,-0.32748775222887355,0.33784149631084043,0.9663655327058085,0.05253372680499081,0.8279290608493851,0.71502188461786,0.8358743296166602,-0.8764837613691621,-0.4189610421194532,0.09174408285979735,0.34850996454002026,0.890505403352621,-0.9720385877580906,-0.3980244652785114,0.9562572599837739,-1.0,-0.24952538467304133,-0.1921330126984941,0.5541517968739144,-0.10327712557151933,-0.31116748931472493,0.6740523496159713,-0.40921309930932115,0.6663243836867554,0.45661718396082396,-0.6179822892023606,0.5665568257738484,-0.7274212053397618,0.7649281145170624,-0.8252453332950108,0.6976327116912497,-0.48575535195899844,-0.8994173391541769,0.9265352609415508,-0.039137675890390564,-0.22457779829739863,0.24833481409005476,0.7264327865317967,-0.202319423510667,0.6302807717781266,-0.6109276768596391,0.3911617489238786,0.9797961990819049,0.5604018628908208,1.0,0.45755217131971604,0.8582482379804294,-0.7779129597605037,-0.8690794157232029,0.8084034644936833,-0.9469354192219425,0.8370114943244757,0.5092081579057175,-0.4647231452483864,-0.010107564350202531,-0.5222792603561606,-0.6704981497827397,0.16425977959515417,0.33528992693441717,0.08135607673617998,-0.9659242757707416,-0.239594160411449,-0.9617928197669356,-0.4937997083844135,0.11393597519857915,-0.3451732892139802,0.7510932362544958,0.8677416968434092,-0.5532983153191926,0.07706289075643923,-0.4912898714571807,-0.872323683732425,-0.7939839619557738,-0.6527623859735983,0.5476279198909612,-0.5709761673708617,0.47375755351788607,0.3292478325467059,0.8055431583568488,0.25090620962943744,0.029225008718517326,-0.3875248575616054,-0.874836093340315,0.21782384540245095,0.31736674504303936,0.5989154093355556,1.0,-0.8483840202908502,-0.5735268522457583,0.5933481298489087,-0.4240634996695426,0.18610488906285366,-0.8189668278776228,0.9385574707040931,-0.5672344094000876,0.11437699228454547,0.45154226398804376,-0.38365173974193656,-0.07665105488517916,0.802956295305103,-0.8585083857897117,0.47314685240401994,-0.32145480203250937,0.053456155989545485,-0.574731500932837,0.6234557405907887,-0.34790551480383697,-0.3447651008732924,-0.6607874263844576,-0.5748011256459264,0.8849138284220875,-0.9021306244414585,-0.3104241740937052,0.5524038223675553,-0.9518158979032976,0.3976760224487391,-0.8801671079341825,-0.7813932707033003,-0.3998580641930599,0.7710050014310103,0.2626992123652348,0.7113248105040857,0.27024590613383176,-0.6570131791097203,-0.6430527657629741,0.6997207900638966,-0.9332460976224723,-0.3632133502141295,-0.27212734757375845,-0.9368461099524785,0.756281805416926,0.7307832827852875,0.09055761117991773,0.6212160768029947,0.975944264109962,-0.9525316872922646,0.5989494649443968,0.4114963094324257,-0.8949791483021297,0.45485845480248627,-0.2654214536912626,0.4963518028925473,0.45221892573286887,-0.08795333708595907,0.1789922127637159,0.25091883217886696,-0.1342579040195672,-0.26668892598860433,-0.08198513884633055,-0.23965462715230512,0.28505188559640776,-0.143065050981613,-0.4121751434875129,0.3099049612574719,0.12107094067968376,-0.43349680318312833,0.13247095920385432,0.207155201032265,0.37817455371512804,-0.40583410226946937,-0.44144460612170905};

		//weights->Set(w);
		J1_S_Field::Configuration conf;
		conf.World = m_world;
		m_scenemgr = new J1_S_Field(&conf);

	}

	void Step(Settings* settings) {
		Test::Step(settings);

		//Draw();
		DrawCircleNest(b2Vec2(0,0), 16, b2Color(0.8f, 0.8f, 0.8f));

		float time = m_stepCount /60.0f;
		char buffer[50];
		sprintf(buffer, "Replay : %6.2fs / 200.00s", time);
		DrawString(50,100,buffer);
	}

	/// Draw Nests.
	void DrawNest(float a) {
		m_debugDraw.DrawSegment(b2Vec2(-a, -a), b2Vec2(-a, a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(-a, a), b2Vec2(a, a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(a, a), b2Vec2(a, -a),
				b2Color(0.8f, 0.8f, 0.8f));
		m_debugDraw.DrawSegment(b2Vec2(a, -a), b2Vec2(-a, -a),
				b2Color(0.8f, 0.8f, 0.8f));
	}
	void DrawCircleNest(const b2Vec2& center, float32 radius, const b2Color& color) {
		m_debugDraw.DrawCircle(center, radius, color);
	}

	static Test* Create() {
		return new Replay_a2Game_Sample;
	}

	void Draw() {
		b2Vec2 w_v[10];
		//walls
		w_v[3] = b2Vec2(-55, -55);
		w_v[2] = b2Vec2(-50, -55);
		w_v[1] = b2Vec2(-50, 55);
		w_v[0] = b2Vec2(-55, 55);
		DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));

		w_v[3] = b2Vec2(-55, -55);
		w_v[2] = b2Vec2(55, -55);
		w_v[1] = b2Vec2(55, -50);
		w_v[0] = b2Vec2(-55, -50);
		DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));

		w_v[3] = b2Vec2(55, -55);
		w_v[2] = b2Vec2(55, 55);
		w_v[1] = b2Vec2(50, 55);
		w_v[0] = b2Vec2(50, -55);
		DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));

		w_v[3] = b2Vec2(55, 55);
		w_v[2] = b2Vec2(-55, 55);
		w_v[1] = b2Vec2(-55, 50);
		w_v[0] = b2Vec2(55, 50);
		DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));

		//food area
		w_v[3] = b2Vec2(50, 50);
		w_v[2] = b2Vec2(-50, 50);
		w_v[1] = b2Vec2(-50, -50);
		w_v[0] = b2Vec2(50, -50);
		DrawSolidPolygon(w_v, 4, b2Color(0.7, 0.7, 0.7));

		//nest
		w_v[3] = b2Vec2(12, 12);
		w_v[2] = b2Vec2(-12, 12);
		w_v[1] = b2Vec2(-12, -12);
		w_v[0] = b2Vec2(12, -12);
		DrawSolidPolygon(w_v, 4, b2Color(0.5, 0.5, 0.5));

		//robots
		for(auto robot : m_scenemgr->GetNodesByTag(MAKE_TAG('r', 'o', 'b', 'o'))) {
			b2Body* bd1 = static_cast<J1_A_Robot*>(robot)->m_motor[0]->GetBody();
			w_v[0] = bd1->GetWorldPoint(b2Vec2(-0.25, -0.1));
			w_v[1] = bd1->GetWorldPoint(b2Vec2(0.25, -0.1));
			w_v[2] = bd1->GetWorldPoint(b2Vec2(0.25, 0.1));
			w_v[3] = bd1->GetWorldPoint(b2Vec2(-0.25, 0.1));
			DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));
			b2Body* bd2 = static_cast<J1_A_Robot*>(robot)->m_motor[1]->GetBody();
			w_v[0] = bd2->GetWorldPoint(b2Vec2(-0.25, -0.1));
			w_v[1] = bd2->GetWorldPoint(b2Vec2(0.25, -0.1));
			w_v[2] = bd2->GetWorldPoint(b2Vec2(0.25, 0.1));
			w_v[3] = bd2->GetWorldPoint(b2Vec2(-0.25, 0.1));
			DrawSolidPolygon(w_v, 4, b2Color(0.2, 0.2, 0.2));
			DrawSolidCircle(static_cast<J1_A_Robot*>(robot)->GetMainComponent()->GetPosition(), 0.5f, b2Color(0.4,0.6,0.8));
		}

		//poison
		for(auto poison : m_scenemgr->GetNodesByTag(MAKE_TAG('p', 'o', 'i', 's'))) {
			auto col = b2Color(0.8, 0.17, 0.17);
			DrawSolidCircle(static_cast<Block*>(poison)->GetPosition(), static_cast<Block*>(poison)->GetBody()->GetFixtureList()->GetShape()->m_radius, col);
		}

		//resource
		for(auto resource : m_scenemgr->GetNodesByTag(MAKE_TAG('r', 'e', 's', 'o'))) {
			auto col = b2Color(0.2, 0.52, 0.3);
			DrawSolidCircle(static_cast<Block*>(resource)->GetPosition(), static_cast<Block*>(resource)->GetBody()->GetFixtureList()->GetShape()->m_radius, col);
		}
	}
};


/////
/////
/////
void DrawSolidCircle(const b2Vec2& center, float32 radius, const b2Color& color)
{
	const float32 k_segments = 16.0f;
	const float32 k_increment = 2.0f * b2_pi / k_segments;
	float32 theta = 0.0f;
	glEnable(GL_BLEND);
	glBlendFunc (GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
	glColor4f(color.r, color.g, color.b, 1);
	glBegin(GL_TRIANGLE_FAN);
	for (int32 i = 0; i < k_segments; ++i)
	{
		b2Vec2 v = center + radius * b2Vec2(cosf(theta), sinf(theta));
		glVertex2f(v.x, v.y);
		theta += k_increment;
	}
	glEnd();
	glDisable(GL_BLEND);

	theta = 0.0f;
	glColor4f(color.r, color.g, color.b, 1);
	glBegin(GL_LINE_LOOP);
	for (int32 i = 0; i < k_segments; ++i)
	{
		b2Vec2 v = center + radius * b2Vec2(cosf(theta), sinf(theta));
		glVertex2f(v.x, v.y);
		theta += k_increment;
	}
	glEnd();
}

void DrawSolidPolygon(const b2Vec2* vertices, int32 vertexCount, const b2Color& color)
{
	glEnable(GL_BLEND);
	glBlendFunc (GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
	glColor4f(color.r, color.g, color.b, 1);
	glBegin(GL_TRIANGLE_FAN);
	for (int32 i = 0; i < vertexCount; ++i)
	{
		glVertex2f(vertices[i].x, vertices[i].y);
	}
	glEnd();
	glDisable(GL_BLEND);

	glColor4f(color.r, color.g, color.b, 1);
	glBegin(GL_LINE_LOOP);
	for (int32 i = 0; i < vertexCount; ++i)
	{
		glVertex2f(vertices[i].x, vertices[i].y);
	}
	glEnd();
}

void DrawString(int x, int y, const char *string, ...)
{
	char buffer[128];

	va_list arg;
	va_start(arg, string);
	vsprintf(buffer, string, arg);
	va_end(arg);

	glMatrixMode(GL_PROJECTION);
	glPushMatrix();
	glLoadIdentity();
	int w = glutGet(GLUT_WINDOW_WIDTH);
	int h = glutGet(GLUT_WINDOW_HEIGHT);
	gluOrtho2D(0, w, h, 0);
	glMatrixMode(GL_MODELVIEW);
	glPushMatrix();
	glLoadIdentity();

	glColor3f(0.9f, 0.6f, 0.6f);
	glRasterPos2i(x, y);
	int32 length = (int32)strlen(buffer);
	for (int32 i = 0; i < length; ++i)
	{
		glutBitmapCharacter(GLUT_BITMAP_HELVETICA_18, buffer[i]);
	}

	glPopMatrix();
	glMatrixMode(GL_PROJECTION);
	glPopMatrix();
	glMatrixMode(GL_MODELVIEW);
}

void DrawString(const b2Vec2& p, const char *string, ...)
{
	char buffer[128];

	va_list arg;
	va_start(arg, string);
	vsprintf(buffer, string, arg);
	va_end(arg);

	glColor3f(0.5f, 0.9f, 0.5f);
	glRasterPos2f(p.x, p.y);

	int32 length = (int32)strlen(buffer);
	for (int32 i = 0; i < length; ++i)
	{
		glutBitmapCharacter(GLUT_BITMAP_8_BY_13, buffer[i]);
	}

	glPopMatrix();
}

void DrawSegment(const b2Vec2& p1, const b2Vec2& p2, const b2Color& color)
{
	glColor3f(color.r, color.g, color.b);
	glBegin(GL_LINES);
	glVertex2f(p1.x, p1.y);
	glVertex2f(p2.x, p2.y);
	glEnd();
}

#endif /* REPLAY_A2GAME_SAMPLE__H_ */
